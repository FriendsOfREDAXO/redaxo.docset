<!DOCTYPE html>
<html lang="de">
 <head>
  <meta charset="utf-8"/>
  <link href="../Assets/css/styles.css" rel="stylesheet"/>
  <script src="../Assets/js/script.js">
  </script>
 </head>
 <body>
  <pre id="source"><code><span class="l" id="1">  1 <span class="xlang">&lt;?php</span>
</span><span class="l" id="2">  2 
</span><span class="l" id="3">  3 <span class="php-comment">/**
</span></span><span class="l" id="4">  4 <span class="php-comment"> * String utility class.
</span></span><span class="l" id="5">  5 <span class="php-comment"> *
</span></span><span class="l" id="6">  6 <span class="php-comment"> * @package redaxo\core
</span></span><span class="l" id="7">  7 <span class="php-comment"> */</span>
</span><span class="l" id="8">  8 <span class="php-keyword1">class</span> rex_string
</span><span class="l" id="9">  9 {
</span><span class="l" id="10"> 10     <span class="php-comment">/**
</span></span><span class="l" id="11"> 11 <span class="php-comment">     * Returns the string size in bytes.
</span></span><span class="l" id="12"> 12 <span class="php-comment">     *
</span></span><span class="l" id="13"> 13 <span class="php-comment">     * @param string $string String
</span></span><span class="l" id="14"> 14 <span class="php-comment">     *
</span></span><span class="l" id="15"> 15 <span class="php-comment">     * @return int Size in bytes
</span></span><span class="l" id="16"> 16 <span class="php-comment">     */</span>
</span><span class="l" id="17"> 17     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> size(<span class="php-var">$string</span>)
</span><span class="l" id="18"> 18     {
</span><span class="l" id="19"> 19         <span class="php-keyword1">return</span> <span class="php-keyword2">mb_strlen</span>(<span class="php-var">$string</span>, <span class="php-quote">'8bit'</span>);
</span><span class="l" id="20"> 20     }
</span><span class="l" id="21"> 21 
</span><span class="l" id="22"> 22     <span class="php-comment">/**
</span></span><span class="l" id="23"> 23 <span class="php-comment">     * Normalizes the encoding of a string (UTF8 NFD to NFC).
</span></span><span class="l" id="24"> 24 <span class="php-comment">     *
</span></span><span class="l" id="25"> 25 <span class="php-comment">     * On HFS+ filesystem (OS X) filenames are stored in UTF8 NFD while all other filesystems are
</span></span><span class="l" id="26"> 26 <span class="php-comment">     * using UTF8 NFC. NFC is more common in general.
</span></span><span class="l" id="27"> 27 <span class="php-comment">     *
</span></span><span class="l" id="28"> 28 <span class="php-comment">     * @param string $string Input string
</span></span><span class="l" id="29"> 29 <span class="php-comment">     *
</span></span><span class="l" id="30"> 30 <span class="php-comment">     * @return string
</span></span><span class="l" id="31"> 31 <span class="php-comment">     */</span>
</span><span class="l" id="32"> 32     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> normalizeEncoding(<span class="php-var">$string</span>)
</span><span class="l" id="33"> 33     {
</span><span class="l" id="34"> 34         <span class="php-keyword1">static</span> <span class="php-var">$normalizer</span>;
</span><span class="l" id="35"> 35 
</span><span class="l" id="36"> 36         <span class="php-keyword1">if</span> (<span class="php-keyword1">null</span> === <span class="php-var">$normalizer</span>) {
</span><span class="l" id="37"> 37             <span class="php-keyword1">if</span> (<span class="php-keyword2">function_exists</span>(<span class="php-quote">'normalizer_normalize'</span>)) {
</span><span class="l" id="38"> 38                 <span class="php-var">$normalizer</span> = <span class="php-keyword1">function</span> (<span class="php-var">$string</span>) {
</span><span class="l" id="39"> 39                     <span class="php-keyword1">return</span> <span class="php-keyword2">normalizer_normalize</span>(<span class="php-var">$string</span>, Normalizer::FORM_C);
</span><span class="l" id="40"> 40                 };
</span><span class="l" id="41"> 41             } <span class="php-keyword1">else</span> {
</span><span class="l" id="42"> 42                 <span class="php-var">$normalizer</span> = <span class="php-keyword1">function</span> (<span class="php-var">$string</span>) {
</span><span class="l" id="43"> 43                     <span class="php-keyword1">return</span> <span class="php-keyword2">str_replace</span>(
</span><span class="l" id="44"> 44                         [<span class="php-quote">"A\xcc\x88"</span>, <span class="php-quote">"a\xcc\x88"</span>, <span class="php-quote">"O\xcc\x88"</span>, <span class="php-quote">"o\xcc\x88"</span>, <span class="php-quote">"U\xcc\x88"</span>, <span class="php-quote">"u\xcc\x88"</span>],
</span><span class="l" id="45"> 45                         [<span class="php-quote">'Ä'</span>, <span class="php-quote">'ä'</span>, <span class="php-quote">'Ö'</span>, <span class="php-quote">'ö'</span>, <span class="php-quote">'Ü'</span>, <span class="php-quote">'ü'</span>],
</span><span class="l" id="46"> 46                         <span class="php-var">$string</span>
</span><span class="l" id="47"> 47                     );
</span><span class="l" id="48"> 48                 };
</span><span class="l" id="49"> 49             }
</span><span class="l" id="50"> 50         }
</span><span class="l" id="51"> 51 
</span><span class="l" id="52"> 52         <span class="php-keyword1">return</span> <span class="php-var">$normalizer</span>(<span class="php-var">$string</span>);
</span><span class="l" id="53"> 53     }
</span><span class="l" id="54"> 54 
</span><span class="l" id="55"> 55     <span class="php-comment">/**
</span></span><span class="l" id="56"> 56 <span class="php-comment">     * Normalizes a string.
</span></span><span class="l" id="57"> 57 <span class="php-comment">     *
</span></span><span class="l" id="58"> 58 <span class="php-comment">     * Makes the string lowercase, replaces umlauts by their ascii representation (ä -&gt; ae etc.), and replaces all
</span></span><span class="l" id="59"> 59 <span class="php-comment">     * other chars that do not match a-z, 0-9 or $allowedChars by $replaceChar.
</span></span><span class="l" id="60"> 60 <span class="php-comment">     *
</span></span><span class="l" id="61"> 61 <span class="php-comment">     * @param string $string       Input string
</span></span><span class="l" id="62"> 62 <span class="php-comment">     * @param string $replaceChar  Character that is used to replace not allowed chars
</span></span><span class="l" id="63"> 63 <span class="php-comment">     * @param string $allowedChars Character whitelist
</span></span><span class="l" id="64"> 64 <span class="php-comment">     *
</span></span><span class="l" id="65"> 65 <span class="php-comment">     * @return string
</span></span><span class="l" id="66"> 66 <span class="php-comment">     */</span>
</span><span class="l" id="67"> 67     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> normalize(<span class="php-var">$string</span>, <span class="php-var">$replaceChar</span> = <span class="php-quote">'_'</span>, <span class="php-var">$allowedChars</span> = <span class="php-quote">''</span>)
</span><span class="l" id="68"> 68     {
</span><span class="l" id="69"> 69         <span class="php-var">$string</span> = self::normalizeEncoding(<span class="php-var">$string</span>);
</span><span class="l" id="70"> 70         <span class="php-var">$string</span> = <span class="php-keyword2">mb_strtolower</span>(<span class="php-var">$string</span>);
</span><span class="l" id="71"> 71         <span class="php-var">$string</span> = <span class="php-keyword2">str_replace</span>([<span class="php-quote">'ä'</span>, <span class="php-quote">'ö'</span>, <span class="php-quote">'ü'</span>, <span class="php-quote">'ß'</span>], [<span class="php-quote">'ae'</span>, <span class="php-quote">'oe'</span>, <span class="php-quote">'ue'</span>, <span class="php-quote">'ss'</span>], <span class="php-var">$string</span>);
</span><span class="l" id="72"> 72         <span class="php-var">$string</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/[^a-z\d'</span> . <span class="php-keyword2">preg_quote</span>(<span class="php-var">$allowedChars</span>, <span class="php-quote">'/'</span>) . <span class="php-quote">']+/ui'</span>, <span class="php-var">$replaceChar</span>, <span class="php-var">$string</span>);
</span><span class="l" id="73"> 73         <span class="php-keyword1">return</span> <span class="php-keyword2">trim</span>(<span class="php-var">$string</span>, <span class="php-var">$replaceChar</span>);
</span><span class="l" id="74"> 74     }
</span><span class="l" id="75"> 75 
</span><span class="l" id="76"> 76     <span class="php-comment">/**
</span></span><span class="l" id="77"> 77 <span class="php-comment">     * Splits a string by spaces
</span></span><span class="l" id="78"> 78 <span class="php-comment">     * (Strings with quotes will be regarded).
</span></span><span class="l" id="79"> 79 <span class="php-comment">     *
</span></span><span class="l" id="80"> 80 <span class="php-comment">     * Examples:
</span></span><span class="l" id="81"> 81 <span class="php-comment">     * "a b 'c d'"   -&gt; array('a', 'b', 'c d')
</span></span><span class="l" id="82"> 82 <span class="php-comment">     * "a=1 b='c d'" -&gt; array('a' =&gt; 1, 'b' =&gt; 'c d')
</span></span><span class="l" id="83"> 83 <span class="php-comment">     *
</span></span><span class="l" id="84"> 84 <span class="php-comment">     * @param string $string
</span></span><span class="l" id="85"> 85 <span class="php-comment">     *
</span></span><span class="l" id="86"> 86 <span class="php-comment">     * @return array
</span></span><span class="l" id="87"> 87 <span class="php-comment">     */</span>
</span><span class="l" id="88"> 88     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> <span class="php-keyword2">split</span>(<span class="php-var">$string</span>)
</span><span class="l" id="89"> 89     {
</span><span class="l" id="90"> 90         <span class="php-var">$string</span> = <span class="php-keyword2">trim</span>(<span class="php-var">$string</span>);
</span><span class="l" id="91"> 91         <span class="php-keyword1">if</span> (<span class="php-keyword1">empty</span>(<span class="php-var">$string</span>)) {
</span><span class="l" id="92"> 92             <span class="php-keyword1">return</span> [];
</span><span class="l" id="93"> 93         }
</span><span class="l" id="94"> 94         <span class="php-var">$result</span> = [];
</span><span class="l" id="95"> 95         <span class="php-var">$spacer</span> = <span class="php-quote">'@@@REX_SPACER@@@'</span>;
</span><span class="l" id="96"> 96         <span class="php-var">$quoted</span> = [];
</span><span class="l" id="97"> 97 
</span><span class="l" id="98"> 98         <span class="php-var">$pattern</span> = <span class="php-quote">'@(?&lt;=\s|=|^)(["\'])((?:.*[^\\\\])?(?:\\\\\\\\)*)\\1(?=\s|$)@Us'</span>;
</span><span class="l" id="99"> 99         <span class="php-var">$callback</span> = <span class="php-keyword1">function</span> (<span class="php-var">$match</span>) <span class="php-keyword1">use</span> (<span class="php-var">$spacer</span>, &amp;<span class="php-var">$quoted</span>) {
</span><span class="l" id="100">100             <span class="php-var">$quoted</span>[] = <span class="php-keyword2">str_replace</span>([<span class="php-quote">'\\'</span> . <span class="php-var">$match</span>[<span class="php-num">1</span>], <span class="php-quote">'\\\\'</span>], [<span class="php-var">$match</span>[<span class="php-num">1</span>], <span class="php-quote">'\\'</span>], <span class="php-var">$match</span>[<span class="php-num">2</span>]);
</span><span class="l" id="101">101             <span class="php-keyword1">return</span> <span class="php-var">$spacer</span>;
</span><span class="l" id="102">102         };
</span><span class="l" id="103">103         <span class="php-var">$string</span> = <span class="php-keyword2">preg_replace_callback</span>(<span class="php-var">$pattern</span>, <span class="php-var">$callback</span>, <span class="php-var">$string</span>);
</span><span class="l" id="104">104 
</span><span class="l" id="105">105         <span class="php-var">$parts</span> = <span class="php-keyword2">preg_split</span>(<span class="php-quote">'@\s+@'</span>, <span class="php-var">$string</span>);
</span><span class="l" id="106">106         <span class="php-var">$i</span> = <span class="php-num">0</span>;
</span><span class="l" id="107">107         <span class="php-keyword1">foreach</span> (<span class="php-var">$parts</span> <span class="php-keyword1">as</span> <span class="php-var">$part</span>) {
</span><span class="l" id="108">108             <span class="php-var">$part</span> = <span class="php-keyword2">explode</span>(<span class="php-quote">'='</span>, <span class="php-var">$part</span>, <span class="php-num">2</span>);
</span><span class="l" id="109">109             <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$part</span>[<span class="php-num">1</span>])) {
</span><span class="l" id="110">110                 <span class="php-var">$value</span> = <span class="php-var">$part</span>[<span class="php-num">1</span>] == <span class="php-var">$spacer</span> ? <span class="php-var">$quoted</span>[<span class="php-var">$i</span>++] : <span class="php-var">$part</span>[<span class="php-num">1</span>];
</span><span class="l" id="111">111                 <span class="php-var">$result</span>[<span class="php-var">$part</span>[<span class="php-num">0</span>]] = <span class="php-var">$value</span>;
</span><span class="l" id="112">112             } <span class="php-keyword1">else</span> {
</span><span class="l" id="113">113                 <span class="php-var">$value</span> = <span class="php-var">$part</span>[<span class="php-num">0</span>] == <span class="php-var">$spacer</span> ? <span class="php-var">$quoted</span>[<span class="php-var">$i</span>++] : <span class="php-var">$part</span>[<span class="php-num">0</span>];
</span><span class="l" id="114">114                 <span class="php-var">$result</span>[] = <span class="php-var">$value</span>;
</span><span class="l" id="115">115             }
</span><span class="l" id="116">116         }
</span><span class="l" id="117">117 
</span><span class="l" id="118">118         <span class="php-keyword1">return</span> <span class="php-var">$result</span>;
</span><span class="l" id="119">119     }
</span><span class="l" id="120">120 
</span><span class="l" id="121">121     <span class="php-comment">/**
</span></span><span class="l" id="122">122 <span class="php-comment">     * Splits a version string.
</span></span><span class="l" id="123">123 <span class="php-comment">     *
</span></span><span class="l" id="124">124 <span class="php-comment">     * @param string $version Version
</span></span><span class="l" id="125">125 <span class="php-comment">     *
</span></span><span class="l" id="126">126 <span class="php-comment">     * @return array Version parts
</span></span><span class="l" id="127">127 <span class="php-comment">     */</span>
</span><span class="l" id="128">128     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> versionSplit(<span class="php-var">$version</span>)
</span><span class="l" id="129">129     {
</span><span class="l" id="130">130         <span class="php-keyword1">return</span> <span class="php-keyword2">preg_split</span>(<span class="php-quote">'/(?&lt;=\d)(?=[a-z])|(?&lt;=[a-z])(?=\d)|[ ._-]+/i'</span>, <span class="php-var">$version</span>);
</span><span class="l" id="131">131     }
</span><span class="l" id="132">132 
</span><span class="l" id="133">133     <span class="php-comment">/**
</span></span><span class="l" id="134">134 <span class="php-comment">     * Compares two version number strings.
</span></span><span class="l" id="135">135 <span class="php-comment">     *
</span></span><span class="l" id="136">136 <span class="php-comment">     * In contrast to version_compare() it treats "1.0" and "1.0.0" as equal and it supports a space as separator for
</span></span><span class="l" id="137">137 <span class="php-comment">     * the version parts, e.g. "1.0 beta1"
</span></span><span class="l" id="138">138 <span class="php-comment">     *
</span></span><span class="l" id="139">139 <span class="php-comment">     * @see http://www.php.net/manual/en/function.version-compare.php
</span></span><span class="l" id="140">140 <span class="php-comment">     *
</span></span><span class="l" id="141">141 <span class="php-comment">     * @param string $version1   First version number
</span></span><span class="l" id="142">142 <span class="php-comment">     * @param string $version2   Second version number
</span></span><span class="l" id="143">143 <span class="php-comment">     * @param string $comparator Optional comparator
</span></span><span class="l" id="144">144 <span class="php-comment">     *
</span></span><span class="l" id="145">145 <span class="php-comment">     * @return int|bool
</span></span><span class="l" id="146">146 <span class="php-comment">     */</span>
</span><span class="l" id="147">147     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> versionCompare(<span class="php-var">$version1</span>, <span class="php-var">$version2</span>, <span class="php-var">$comparator</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="148">148     {
</span><span class="l" id="149">149         <span class="php-var">$version1</span> = self::versionSplit(<span class="php-var">$version1</span>);
</span><span class="l" id="150">150         <span class="php-var">$version2</span> = self::versionSplit(<span class="php-var">$version2</span>);
</span><span class="l" id="151">151         <span class="php-var">$max</span> = <span class="php-keyword2">max</span>(<span class="php-keyword2">count</span>(<span class="php-var">$version1</span>), <span class="php-keyword2">count</span>(<span class="php-var">$version2</span>));
</span><span class="l" id="152">152         <span class="php-var">$version1</span> = <span class="php-keyword2">implode</span>(<span class="php-quote">'.'</span>, <span class="php-keyword2">array_pad</span>(<span class="php-var">$version1</span>, <span class="php-var">$max</span>, <span class="php-quote">'0'</span>));
</span><span class="l" id="153">153         <span class="php-var">$version2</span> = <span class="php-keyword2">implode</span>(<span class="php-quote">'.'</span>, <span class="php-keyword2">array_pad</span>(<span class="php-var">$version2</span>, <span class="php-var">$max</span>, <span class="php-quote">'0'</span>));
</span><span class="l" id="154">154         <span class="php-keyword1">return</span> <span class="php-keyword2">version_compare</span>(<span class="php-var">$version1</span>, <span class="php-var">$version2</span>, <span class="php-var">$comparator</span>);
</span><span class="l" id="155">155     }
</span><span class="l" id="156">156 
</span><span class="l" id="157">157     <span class="php-comment">/**
</span></span><span class="l" id="158">158 <span class="php-comment">     * Returns a string containing the YAML representation of $value.
</span></span><span class="l" id="159">159 <span class="php-comment">     *
</span></span><span class="l" id="160">160 <span class="php-comment">     * @param array $value  The value being encoded
</span></span><span class="l" id="161">161 <span class="php-comment">     * @param int   $inline The level where you switch to inline YAML
</span></span><span class="l" id="162">162 <span class="php-comment">     *
</span></span><span class="l" id="163">163 <span class="php-comment">     * @return string
</span></span><span class="l" id="164">164 <span class="php-comment">     */</span>
</span><span class="l" id="165">165     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> yamlEncode(<span class="php-keyword1">array</span> <span class="php-var">$value</span>, <span class="php-var">$inline</span> = <span class="php-num">3</span>)
</span><span class="l" id="166">166     {
</span><span class="l" id="167">167         <span class="php-keyword1">return</span> Symfony\Component\Yaml\Yaml::dump(<span class="php-var">$value</span>, <span class="php-var">$inline</span>, <span class="php-num">4</span>);
</span><span class="l" id="168">168     }
</span><span class="l" id="169">169 
</span><span class="l" id="170">170     <span class="php-comment">/**
</span></span><span class="l" id="171">171 <span class="php-comment">     * Parses YAML into a PHP array.
</span></span><span class="l" id="172">172 <span class="php-comment">     *
</span></span><span class="l" id="173">173 <span class="php-comment">     * @param string $value YAML string
</span></span><span class="l" id="174">174 <span class="php-comment">     *
</span></span><span class="l" id="175">175 <span class="php-comment">     * @return array
</span></span><span class="l" id="176">176 <span class="php-comment">     *
</span></span><span class="l" id="177">177 <span class="php-comment">     * @throws rex_yaml_parse_exception
</span></span><span class="l" id="178">178 <span class="php-comment">     */</span>
</span><span class="l" id="179">179     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> yamlDecode(<span class="php-var">$value</span>)
</span><span class="l" id="180">180     {
</span><span class="l" id="181">181         <span class="php-keyword1">try</span> {
</span><span class="l" id="182">182             <span class="php-keyword1">return</span> Symfony\Component\Yaml\Yaml::parse(<span class="php-var">$value</span>);
</span><span class="l" id="183">183         } <span class="php-keyword1">catch</span> (Symfony\Component\Yaml\Exception\ParseException <span class="php-var">$exception</span>) {
</span><span class="l" id="184">184             <span class="php-keyword1">throw</span> <span class="php-keyword1">new</span> rex_yaml_parse_exception(<span class="php-var">$exception</span>-&gt;getMessage(), <span class="php-var">$exception</span>);
</span><span class="l" id="185">185         }
</span><span class="l" id="186">186     }
</span><span class="l" id="187">187 
</span><span class="l" id="188">188     <span class="php-comment">/**
</span></span><span class="l" id="189">189 <span class="php-comment">     * Generates URL-encoded query string.
</span></span><span class="l" id="190">190 <span class="php-comment">     *
</span></span><span class="l" id="191">191 <span class="php-comment">     * @param array  $params
</span></span><span class="l" id="192">192 <span class="php-comment">     * @param string $argSeparator
</span></span><span class="l" id="193">193 <span class="php-comment">     *
</span></span><span class="l" id="194">194 <span class="php-comment">     * @return string
</span></span><span class="l" id="195">195 <span class="php-comment">     */</span>
</span><span class="l" id="196">196     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> buildQuery(<span class="php-keyword1">array</span> <span class="php-var">$params</span>, <span class="php-var">$argSeparator</span> = <span class="php-quote">'&amp;'</span>)
</span><span class="l" id="197">197     {
</span><span class="l" id="198">198         <span class="php-var">$query</span> = [];
</span><span class="l" id="199">199         <span class="php-var">$func</span> = <span class="php-keyword1">function</span> (<span class="php-keyword1">array</span> <span class="php-var">$params</span>, <span class="php-var">$fullkey</span> = <span class="php-keyword1">null</span>) <span class="php-keyword1">use</span> (&amp;<span class="php-var">$query</span>, &amp;<span class="php-var">$func</span>) {
</span><span class="l" id="200">200             <span class="php-keyword1">foreach</span> (<span class="php-var">$params</span> <span class="php-keyword1">as</span> <span class="php-var">$key</span> =&gt; <span class="php-var">$value</span>) {
</span><span class="l" id="201">201                 <span class="php-var">$key</span> = <span class="php-var">$fullkey</span> ? <span class="php-var">$fullkey</span> . <span class="php-quote">'['</span> . <span class="php-keyword2">urlencode</span>(<span class="php-var">$key</span>) . <span class="php-quote">']'</span> : <span class="php-keyword2">urlencode</span>(<span class="php-var">$key</span>);
</span><span class="l" id="202">202                 <span class="php-keyword1">if</span> (<span class="php-keyword2">is_array</span>(<span class="php-var">$value</span>)) {
</span><span class="l" id="203">203                     <span class="php-var">$func</span>(<span class="php-var">$value</span>, <span class="php-var">$key</span>);
</span><span class="l" id="204">204                 } <span class="php-keyword1">else</span> {
</span><span class="l" id="205">205                     <span class="php-var">$query</span>[] = <span class="php-var">$key</span> . <span class="php-quote">'='</span> . <span class="php-keyword2">str_replace</span>(<span class="php-quote">'%2F'</span>, <span class="php-quote">'/'</span>, <span class="php-keyword2">urlencode</span>(<span class="php-var">$value</span>));
</span><span class="l" id="206">206                 }
</span><span class="l" id="207">207             }
</span><span class="l" id="208">208         };
</span><span class="l" id="209">209         <span class="php-var">$func</span>(<span class="php-var">$params</span>);
</span><span class="l" id="210">210         <span class="php-keyword1">return</span> <span class="php-keyword2">implode</span>(<span class="php-var">$argSeparator</span>, <span class="php-var">$query</span>);
</span><span class="l" id="211">211     }
</span><span class="l" id="212">212 
</span><span class="l" id="213">213     <span class="php-comment">/**
</span></span><span class="l" id="214">214 <span class="php-comment">     * Returns a string by key="value" pair.
</span></span><span class="l" id="215">215 <span class="php-comment">     *
</span></span><span class="l" id="216">216 <span class="php-comment">     * @param array $attributes
</span></span><span class="l" id="217">217 <span class="php-comment">     *
</span></span><span class="l" id="218">218 <span class="php-comment">     * @return string
</span></span><span class="l" id="219">219 <span class="php-comment">     */</span>
</span><span class="l" id="220">220     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> buildAttributes(<span class="php-keyword1">array</span> <span class="php-var">$attributes</span>)
</span><span class="l" id="221">221     {
</span><span class="l" id="222">222         <span class="php-var">$attr</span> = <span class="php-quote">''</span>;
</span><span class="l" id="223">223 
</span><span class="l" id="224">224         <span class="php-keyword1">foreach</span> (<span class="php-var">$attributes</span> <span class="php-keyword1">as</span> <span class="php-var">$key</span> =&gt; <span class="php-var">$value</span>) {
</span><span class="l" id="225">225             <span class="php-keyword1">if</span> (<span class="php-keyword2">is_int</span>(<span class="php-var">$key</span>)) {
</span><span class="l" id="226">226                 <span class="php-var">$attr</span> .= <span class="php-quote">' '</span> . rex_escape(<span class="php-var">$value</span>);
</span><span class="l" id="227">227             } <span class="php-keyword1">else</span> {
</span><span class="l" id="228">228                 <span class="php-keyword1">if</span> (<span class="php-keyword2">is_array</span>(<span class="php-var">$value</span>)) {
</span><span class="l" id="229">229                     <span class="php-var">$value</span> = <span class="php-keyword2">implode</span>(<span class="php-quote">' '</span>, <span class="php-var">$value</span>);
</span><span class="l" id="230">230                 }
</span><span class="l" id="231">231                 <span class="php-comment">// for bc reasons avoid double escaping of "&amp;", especially in already escaped urls</span>
</span><span class="l" id="232">232                 <span class="php-var">$value</span> = <span class="php-keyword2">str_replace</span>(<span class="php-quote">'&amp;amp;'</span>, <span class="php-quote">'&amp;'</span>, <span class="php-var">$value</span>);
</span><span class="l" id="233">233                 <span class="php-var">$attr</span> .= <span class="php-quote">' '</span> . rex_escape(<span class="php-var">$key</span>) . <span class="php-quote">'="'</span> . rex_escape(<span class="php-var">$value</span>) . <span class="php-quote">'"'</span>;
</span><span class="l" id="234">234             }
</span><span class="l" id="235">235         }
</span><span class="l" id="236">236 
</span><span class="l" id="237">237         <span class="php-keyword1">return</span> <span class="php-var">$attr</span>;
</span><span class="l" id="238">238     }
</span><span class="l" id="239">239 
</span><span class="l" id="240">240     <span class="php-comment">/**
</span></span><span class="l" id="241">241 <span class="php-comment">     * Highlights a string.
</span></span><span class="l" id="242">242 <span class="php-comment">     *
</span></span><span class="l" id="243">243 <span class="php-comment">     * @param string $string
</span></span><span class="l" id="244">244 <span class="php-comment">     *
</span></span><span class="l" id="245">245 <span class="php-comment">     * @return string
</span></span><span class="l" id="246">246 <span class="php-comment">     */</span>
</span><span class="l" id="247">247     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> highlight(<span class="php-var">$string</span>)
</span><span class="l" id="248">248     {
</span><span class="l" id="249">249         <span class="php-var">$return</span> = <span class="php-keyword2">str_replace</span>([<span class="php-quote">"\r"</span>, <span class="php-quote">"\n"</span>], [<span class="php-quote">''</span>, <span class="php-quote">''</span>], <span class="php-keyword2">highlight_string</span>(<span class="php-var">$string</span>, <span class="php-keyword1">true</span>));
</span><span class="l" id="250">250         <span class="php-keyword1">return</span> <span class="php-quote">'&lt;pre class="rex-code"&gt;'</span> . <span class="php-var">$return</span> . <span class="php-quote">'&lt;/pre&gt;'</span>;
</span><span class="l" id="251">251     }
</span><span class="l" id="252">252 }
</span><span class="l" id="253">253 </span></code></pre>
 </body>
</html>
