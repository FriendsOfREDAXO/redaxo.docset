<!DOCTYPE html>
<html lang="de">
 <head>
  <meta charset="utf-8"/>
  <link href="../Assets/css/styles.css" rel="stylesheet"/>
  <script src="../Assets/js/script.js">
  </script>
 </head>
 <body>
  <pre id="source"><code><span class="l" id="1"> 1 <span class="xlang">&lt;?php</span>
</span><span class="l" id="2"> 2 
</span><span class="l" id="3"> 3 <span class="php-comment">/**
</span></span><span class="l" id="4"> 4 <span class="php-comment"> * URL Funktionen.
</span></span><span class="l" id="5"> 5 <span class="php-comment"> *
</span></span><span class="l" id="6"> 6 <span class="php-comment"> * @package redaxo\structure
</span></span><span class="l" id="7"> 7 <span class="php-comment"> */</span>
</span><span class="l" id="8"> 8 
</span><span class="l" id="9"> 9 <span class="php-comment">/**
</span></span><span class="l" id="10">10 <span class="php-comment"> * Gibt eine Url zu einem Artikel zur√ºck.
</span></span><span class="l" id="11">11 <span class="php-comment"> *
</span></span><span class="l" id="12">12 <span class="php-comment"> * @param int|string|null $id
</span></span><span class="l" id="13">13 <span class="php-comment"> * @param int|string|null $clang     SprachId des Artikels
</span></span><span class="l" id="14">14 <span class="php-comment"> * @param array           $params    Array von Parametern
</span></span><span class="l" id="15">15 <span class="php-comment"> * @param string          $separator
</span></span><span class="l" id="16">16 <span class="php-comment"> *
</span></span><span class="l" id="17">17 <span class="php-comment"> * @return string
</span></span><span class="l" id="18">18 <span class="php-comment"> *
</span></span><span class="l" id="19">19 <span class="php-comment"> * @package redaxo\structure
</span></span><span class="l" id="20">20 <span class="php-comment"> */</span>
</span><span class="l" id="21">21 <span class="php-keyword1">function</span> rex_getUrl(<span class="php-var">$id</span> = <span class="php-keyword1">null</span>, <span class="php-var">$clang</span> = <span class="php-keyword1">null</span>, <span class="php-keyword1">array</span> <span class="php-var">$params</span> = [], <span class="php-var">$separator</span> = <span class="php-quote">'&amp;amp;'</span>)
</span><span class="l" id="22">22 {
</span><span class="l" id="23">23     <span class="php-var">$id</span> = (int) <span class="php-var">$id</span>;
</span><span class="l" id="24">24     <span class="php-var">$clang</span> = (int) <span class="php-var">$clang</span>;
</span><span class="l" id="25">25 
</span><span class="l" id="26">26     <span class="php-comment">// ----- get id</span>
</span><span class="l" id="27">27     <span class="php-keyword1">if</span> (<span class="php-var">$id</span> == <span class="php-num">0</span>) {
</span><span class="l" id="28">28         <span class="php-var">$id</span> = rex_article::getCurrentId();
</span><span class="l" id="29">29     }
</span><span class="l" id="30">30 
</span><span class="l" id="31">31     <span class="php-comment">// ----- get clang</span>
</span><span class="l" id="32">32     <span class="php-comment">// Wenn eine rexExtension vorhanden ist, immer die clang mitgeben!</span>
</span><span class="l" id="33">33     <span class="php-comment">// Die rexExtension muss selbst entscheiden was sie damit macht</span>
</span><span class="l" id="34">34     <span class="php-keyword1">if</span> (!rex_clang::exists(<span class="php-var">$clang</span>) &amp;&amp; (rex_clang::<span class="php-keyword2">count</span>() &gt; <span class="php-num">1</span> || rex_extension::isRegistered(<span class="php-quote">'URL_REWRITE'</span>))) {
</span><span class="l" id="35">35         <span class="php-var">$clang</span> = rex_clang::getCurrentId();
</span><span class="l" id="36">36     }
</span><span class="l" id="37">37 
</span><span class="l" id="38">38     <span class="php-comment">// ----- EXTENSION POINT</span>
</span><span class="l" id="39">39     <span class="php-var">$url</span> = rex_extension::registerPoint(<span class="php-keyword1">new</span> rex_extension_point(<span class="php-quote">'URL_REWRITE'</span>, <span class="php-quote">''</span>, [<span class="php-quote">'id'</span> =&gt; <span class="php-var">$id</span>, <span class="php-quote">'clang'</span> =&gt; <span class="php-var">$clang</span>, <span class="php-quote">'params'</span> =&gt; <span class="php-var">$params</span>, <span class="php-quote">'separator'</span> =&gt; <span class="php-var">$separator</span>]));
</span><span class="l" id="40">40 
</span><span class="l" id="41">41     <span class="php-keyword1">if</span> (<span class="php-var">$url</span> == <span class="php-quote">''</span>) {
</span><span class="l" id="42">42         <span class="php-keyword1">if</span> (rex_clang::<span class="php-keyword2">count</span>() &gt; <span class="php-num">1</span>) {
</span><span class="l" id="43">43             <span class="php-var">$clang</span> = <span class="php-var">$separator</span> . <span class="php-quote">'clang='</span> . <span class="php-var">$clang</span>;
</span><span class="l" id="44">44         } <span class="php-keyword1">else</span> {
</span><span class="l" id="45">45             <span class="php-var">$clang</span> = <span class="php-quote">''</span>;
</span><span class="l" id="46">46         }
</span><span class="l" id="47">47 
</span><span class="l" id="48">48         <span class="php-var">$params</span> = rex_string::buildQuery(<span class="php-var">$params</span>, <span class="php-var">$separator</span>);
</span><span class="l" id="49">49         <span class="php-var">$params</span> = <span class="php-var">$params</span> ? <span class="php-var">$separator</span> . <span class="php-var">$params</span> : <span class="php-quote">''</span>;
</span><span class="l" id="50">50 
</span><span class="l" id="51">51         <span class="php-var">$url</span> = rex_url::frontendController() . <span class="php-quote">'?article_id='</span> . <span class="php-var">$id</span> . <span class="php-var">$clang</span> . <span class="php-var">$params</span>;
</span><span class="l" id="52">52     }
</span><span class="l" id="53">53 
</span><span class="l" id="54">54     <span class="php-keyword1">return</span> <span class="php-var">$url</span>;
</span><span class="l" id="55">55 }
</span><span class="l" id="56">56 
</span><span class="l" id="57">57 <span class="php-comment">/**
</span></span><span class="l" id="58">58 <span class="php-comment"> * Leitet auf einen anderen Artikel weiter.
</span></span><span class="l" id="59">59 <span class="php-comment"> *
</span></span><span class="l" id="60">60 <span class="php-comment"> * @param null|int|string $article_id
</span></span><span class="l" id="61">61 <span class="php-comment"> * @param null|int|string $clang      SprachId des Artikels
</span></span><span class="l" id="62">62 <span class="php-comment"> *
</span></span><span class="l" id="63">63 <span class="php-comment"> * @throws InvalidArgumentException
</span></span><span class="l" id="64">64 <span class="php-comment"> *
</span></span><span class="l" id="65">65 <span class="php-comment"> * @package redaxo\structure
</span></span><span class="l" id="66">66 <span class="php-comment"> */</span>
</span><span class="l" id="67">67 <span class="php-keyword1">function</span> rex_redirect(<span class="php-var">$article_id</span>, <span class="php-var">$clang</span> = <span class="php-keyword1">null</span>, <span class="php-keyword1">array</span> <span class="php-var">$params</span> = [])
</span><span class="l" id="68">68 {
</span><span class="l" id="69">69     <span class="php-keyword1">if</span> (<span class="php-keyword1">null</span> !== <span class="php-var">$article_id</span> &amp;&amp; <span class="php-quote">''</span> !== <span class="php-var">$article_id</span> &amp;&amp; !<span class="php-keyword2">is_int</span>(<span class="php-var">$article_id</span>) &amp;&amp; <span class="php-var">$article_id</span> !== (string) (int) <span class="php-var">$article_id</span>) {
</span><span class="l" id="70">70         <span class="php-keyword1">throw</span> <span class="php-keyword1">new</span> InvalidArgumentException(<span class="php-keyword2">sprintf</span>(<span class="php-quote">'"%s" is not a valid article_id!'</span>, <span class="php-var">$article_id</span>));
</span><span class="l" id="71">71     }
</span><span class="l" id="72">72 
</span><span class="l" id="73">73     rex_response::sendRedirect(rex_getUrl(<span class="php-var">$article_id</span>, <span class="php-var">$clang</span>, <span class="php-var">$params</span>, <span class="php-quote">'&amp;'</span>));
</span><span class="l" id="74">74 }
</span><span class="l" id="75">75 </span></code></pre>
 </body>
</html>
