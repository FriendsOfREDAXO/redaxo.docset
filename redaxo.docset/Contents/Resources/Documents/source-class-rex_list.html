<!DOCTYPE html>
<html lang="de">
 <head>
  <meta charset="utf-8"/>
  <link href="../Assets/css/styles.css" rel="stylesheet"/>
  <script src="../Assets/js/script.js">
  </script>
 </head>
 <body>
  <pre id="source"><code><span class="l" id="1">   1 <span class="xlang">&lt;?php</span>
</span><span class="l" id="2">   2 
</span><span class="l" id="3">   3 <span class="php-comment">// Nötige Konstanten</span>
</span><span class="l" id="4">   4 <span class="php-keyword2">define</span>(<span class="php-quote">'REX_LIST_OPT_SORT'</span>, <span class="php-num">0</span>);
</span><span class="l" id="5">   5 <span class="php-keyword2">define</span>(<span class="php-quote">'REX_LIST_OPT_SORT_DIRECTION'</span>, <span class="php-num">1</span>);
</span><span class="l" id="6">   6 
</span><span class="l" id="7">   7 <span class="php-comment">/*
</span></span><span class="l" id="8">   8 <span class="php-comment">EXAMPLE:
</span></span><span class="l" id="9">   9 <span class="php-comment">
</span></span><span class="l" id="10">  10 <span class="php-comment">$list = rex_list::factory('SELECT id,name FROM rex_article');
</span></span><span class="l" id="11">  11 <span class="php-comment">$list-&gt;setColumnFormat('id', 'date');
</span></span><span class="l" id="12">  12 <span class="php-comment">$list-&gt;setColumnLabel('name', 'Artikel-Name');
</span></span><span class="l" id="13">  13 <span class="php-comment">$list-&gt;setColumnSortable('name');
</span></span><span class="l" id="14">  14 <span class="php-comment">$list-&gt;addColumn('testhead','###id### - ###name###',-1);
</span></span><span class="l" id="15">  15 <span class="php-comment">$list-&gt;addColumn('testhead2','testbody2');
</span></span><span class="l" id="16">  16 <span class="php-comment">$list-&gt;setCaption('thomas macht das css');
</span></span><span class="l" id="17">  17 <span class="php-comment">$list-&gt;show();
</span></span><span class="l" id="18">  18 <span class="php-comment">
</span></span><span class="l" id="19">  19 <span class="php-comment">
</span></span><span class="l" id="20">  20 <span class="php-comment">EXAMPLE FOR USING CUSTOM CALLBACKS WITH setColumnFormat() METHOD:
</span></span><span class="l" id="21">  21 <span class="php-comment">
</span></span><span class="l" id="22">  22 <span class="php-comment">function callback_func($params)
</span></span><span class="l" id="23">  23 <span class="php-comment">{
</span></span><span class="l" id="24">  24 <span class="php-comment">    // $params['subject']  current value
</span></span><span class="l" id="25">  25 <span class="php-comment">    // $params['list']     rex_list object
</span></span><span class="l" id="26">  26 <span class="php-comment">    // $params['params']   custom params
</span></span><span class="l" id="27">  27 <span class="php-comment">
</span></span><span class="l" id="28">  28 <span class="php-comment">    return $custom_string; // return value showed in list (note: no htmlspechialchars!)
</span></span><span class="l" id="29">  29 <span class="php-comment">}
</span></span><span class="l" id="30">  30 <span class="php-comment">
</span></span><span class="l" id="31">  31 <span class="php-comment">// USING setColumnFormat() BY CALLING A FUNCTION
</span></span><span class="l" id="32">  32 <span class="php-comment">$list-&gt;setColumnFormat('id',                                     // field name
</span></span><span class="l" id="33">  33 <span class="php-comment">                                             'custom',                                 // format type
</span></span><span class="l" id="34">  34 <span class="php-comment">                                             'callback_func',                          // callback function name
</span></span><span class="l" id="35">  35 <span class="php-comment">                                                array('foo' =&gt; 'bar', '123' =&gt; '456')    // optional params for callback function
</span></span><span class="l" id="36">  36 <span class="php-comment">);
</span></span><span class="l" id="37">  37 <span class="php-comment">
</span></span><span class="l" id="38">  38 <span class="php-comment">// USING setColumnFormat() BY CALLING CLASS &amp; METHOD
</span></span><span class="l" id="39">  39 <span class="php-comment">$list-&gt;setColumnFormat('id',                                     // field name
</span></span><span class="l" id="40">  40 <span class="php-comment">                                             'custom',                                 // format type
</span></span><span class="l" id="41">  41 <span class="php-comment">                                                array('CLASS','METHOD'),                 // callback class/method name
</span></span><span class="l" id="42">  42 <span class="php-comment">                                                array('foo' =&gt; 'bar', '123' =&gt; '456')    // optional params for callback function
</span></span><span class="l" id="43">  43 <span class="php-comment">                                             );
</span></span><span class="l" id="44">  44 <span class="php-comment">*/</span>
</span><span class="l" id="45">  45 
</span><span class="l" id="46">  46 <span class="php-comment">/**
</span></span><span class="l" id="47">  47 <span class="php-comment"> * Klasse zum erstellen von Listen.
</span></span><span class="l" id="48">  48 <span class="php-comment"> *
</span></span><span class="l" id="49">  49 <span class="php-comment"> * @package redaxo\core
</span></span><span class="l" id="50">  50 <span class="php-comment"> */</span>
</span><span class="l" id="51">  51 <span class="php-keyword1">class</span> rex_list <span class="php-keyword1">implements</span> rex_url_provider_interface
</span><span class="l" id="52">  52 {
</span><span class="l" id="53">  53     <span class="php-keyword1">use</span> rex_factory_trait;
</span><span class="l" id="54">  54 
</span><span class="l" id="55">  55     <span class="php-keyword1">private</span> <span class="php-var">$query</span>;
</span><span class="l" id="56">  56     <span class="php-keyword1">private</span> <span class="php-var">$sql</span>;
</span><span class="l" id="57">  57     <span class="php-keyword1">private</span> <span class="php-var">$debug</span>;
</span><span class="l" id="58">  58     <span class="php-keyword1">private</span> <span class="php-var">$noRowsMessage</span>;
</span><span class="l" id="59">  59 
</span><span class="l" id="60">  60     <span class="php-comment">// --------- List Attributes</span>
</span><span class="l" id="61">  61     <span class="php-keyword1">private</span> <span class="php-var">$name</span>;
</span><span class="l" id="62">  62     <span class="php-keyword1">private</span> <span class="php-var">$params</span>;
</span><span class="l" id="63">  63     <span class="php-keyword1">private</span> <span class="php-var">$rows</span>;
</span><span class="l" id="64">  64 
</span><span class="l" id="65">  65     <span class="php-comment">// --------- Form Attributes</span>
</span><span class="l" id="66">  66     <span class="php-keyword1">private</span> <span class="php-var">$formAttributes</span>;
</span><span class="l" id="67">  67 
</span><span class="l" id="68">  68     <span class="php-comment">// --------- Column Attributes</span>
</span><span class="l" id="69">  69     <span class="php-keyword1">private</span> <span class="php-var">$customColumns</span>;
</span><span class="l" id="70">  70     <span class="php-keyword1">private</span> <span class="php-var">$columnNames</span>;
</span><span class="l" id="71">  71     <span class="php-keyword1">private</span> <span class="php-var">$columnLabels</span>;
</span><span class="l" id="72">  72     <span class="php-keyword1">private</span> <span class="php-var">$columnFormates</span>;
</span><span class="l" id="73">  73     <span class="php-keyword1">private</span> <span class="php-var">$columnOptions</span>;
</span><span class="l" id="74">  74     <span class="php-keyword1">private</span> <span class="php-var">$columnAttributes</span>;
</span><span class="l" id="75">  75     <span class="php-keyword1">private</span> <span class="php-var">$columnLayouts</span>;
</span><span class="l" id="76">  76     <span class="php-keyword1">private</span> <span class="php-var">$columnParams</span>;
</span><span class="l" id="77">  77     <span class="php-keyword1">private</span> <span class="php-var">$columnDisabled</span>;
</span><span class="l" id="78">  78 
</span><span class="l" id="79">  79     <span class="php-comment">// --------- Layout, Default</span>
</span><span class="l" id="80">  80     <span class="php-keyword1">private</span> <span class="php-var">$defaultColumnLayout</span>;
</span><span class="l" id="81">  81 
</span><span class="l" id="82">  82     <span class="php-comment">// --------- Table Attributes</span>
</span><span class="l" id="83">  83     <span class="php-keyword1">private</span> <span class="php-var">$caption</span>;
</span><span class="l" id="84">  84     <span class="php-keyword1">private</span> <span class="php-var">$tableAttributes</span>;
</span><span class="l" id="85">  85     <span class="php-keyword1">private</span> <span class="php-var">$tableColumnGroups</span>;
</span><span class="l" id="86">  86 
</span><span class="l" id="87">  87     <span class="php-comment">// --------- Link Attributes</span>
</span><span class="l" id="88">  88     <span class="php-keyword1">private</span> <span class="php-var">$linkAttributes</span>;
</span><span class="l" id="89">  89 
</span><span class="l" id="90">  90     <span class="php-comment">// --------- Pagination Attributes</span>
</span><span class="l" id="91">  91     <span class="php-keyword1">private</span> <span class="php-var">$pager</span>;
</span><span class="l" id="92">  92 
</span><span class="l" id="93">  93     <span class="php-comment">/**
</span></span><span class="l" id="94">  94 <span class="php-comment">     * Erstellt ein rex_list Objekt.
</span></span><span class="l" id="95">  95 <span class="php-comment">     *
</span></span><span class="l" id="96">  96 <span class="php-comment">     * @param string $query       SELECT Statement
</span></span><span class="l" id="97">  97 <span class="php-comment">     * @param int    $rowsPerPage Anzahl der Elemente pro Zeile
</span></span><span class="l" id="98">  98 <span class="php-comment">     * @param string $listName    Name der Liste
</span></span><span class="l" id="99">  99 <span class="php-comment">     * @param bool   $debug
</span></span><span class="l" id="100"> 100 <span class="php-comment">     */</span>
</span><span class="l" id="101"> 101     <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> __construct(<span class="php-var">$query</span>, <span class="php-var">$rowsPerPage</span> = <span class="php-num">30</span>, <span class="php-var">$listName</span> = <span class="php-keyword1">null</span>, <span class="php-var">$debug</span> = <span class="php-keyword1">false</span>)
</span><span class="l" id="102"> 102     {
</span><span class="l" id="103"> 103         <span class="php-comment">// --------- Validation</span>
</span><span class="l" id="104"> 104         <span class="php-keyword1">if</span> (!<span class="php-var">$listName</span>) {
</span><span class="l" id="105"> 105             <span class="php-var">$listName</span> = <span class="php-keyword2">md5</span>(<span class="php-var">$query</span>);
</span><span class="l" id="106"> 106         }
</span><span class="l" id="107"> 107 
</span><span class="l" id="108"> 108         <span class="php-comment">// --------- List Attributes</span>
</span><span class="l" id="109"> 109         <span class="php-var">$this</span>-&gt;query = <span class="php-var">$query</span>;
</span><span class="l" id="110"> 110         <span class="php-var">$this</span>-&gt;sql = rex_sql::factory();
</span><span class="l" id="111"> 111         <span class="php-var">$this</span>-&gt;debug = <span class="php-var">$debug</span>;
</span><span class="l" id="112"> 112         <span class="php-var">$this</span>-&gt;sql-&gt;setDebug(<span class="php-var">$this</span>-&gt;debug);
</span><span class="l" id="113"> 113         <span class="php-var">$this</span>-&gt;name = <span class="php-var">$listName</span>;
</span><span class="l" id="114"> 114         <span class="php-var">$this</span>-&gt;caption = <span class="php-quote">''</span>;
</span><span class="l" id="115"> 115         <span class="php-var">$this</span>-&gt;rows = <span class="php-num">0</span>;
</span><span class="l" id="116"> 116         <span class="php-var">$this</span>-&gt;params = [];
</span><span class="l" id="117"> 117         <span class="php-var">$this</span>-&gt;tableAttributes = [];
</span><span class="l" id="118"> 118         <span class="php-var">$this</span>-&gt;noRowsMessage = rex_i18n::msg(<span class="php-quote">'list_no_rows'</span>);
</span><span class="l" id="119"> 119 
</span><span class="l" id="120"> 120         <span class="php-comment">// --------- Form Attributes</span>
</span><span class="l" id="121"> 121         <span class="php-var">$this</span>-&gt;formAttributes = [];
</span><span class="l" id="122"> 122 
</span><span class="l" id="123"> 123         <span class="php-comment">// --------- Column Attributes</span>
</span><span class="l" id="124"> 124         <span class="php-var">$this</span>-&gt;customColumns = [];
</span><span class="l" id="125"> 125         <span class="php-var">$this</span>-&gt;columnLabels = [];
</span><span class="l" id="126"> 126         <span class="php-var">$this</span>-&gt;columnFormates = [];
</span><span class="l" id="127"> 127         <span class="php-var">$this</span>-&gt;columnParams = [];
</span><span class="l" id="128"> 128         <span class="php-var">$this</span>-&gt;columnOptions = [];
</span><span class="l" id="129"> 129         <span class="php-var">$this</span>-&gt;columnAttributes = [];
</span><span class="l" id="130"> 130         <span class="php-var">$this</span>-&gt;columnLayouts = [];
</span><span class="l" id="131"> 131         <span class="php-var">$this</span>-&gt;columnDisabled = [];
</span><span class="l" id="132"> 132 
</span><span class="l" id="133"> 133         <span class="php-comment">// --------- Default</span>
</span><span class="l" id="134"> 134         <span class="php-var">$this</span>-&gt;defaultColumnLayout = [<span class="php-quote">'&lt;th&gt;###VALUE###&lt;/th&gt;'</span>, <span class="php-quote">'&lt;td data-title="###LABEL###"&gt;###VALUE###&lt;/td&gt;'</span>];
</span><span class="l" id="135"> 135 
</span><span class="l" id="136"> 136         <span class="php-comment">// --------- Table Attributes</span>
</span><span class="l" id="137"> 137         <span class="php-var">$this</span>-&gt;tableAttributes = [];
</span><span class="l" id="138"> 138         <span class="php-var">$this</span>-&gt;tableColumnGroups = [];
</span><span class="l" id="139"> 139 
</span><span class="l" id="140"> 140         <span class="php-comment">// --------- Link Attributes</span>
</span><span class="l" id="141"> 141         <span class="php-var">$this</span>-&gt;linkAttributes = [];
</span><span class="l" id="142"> 142 
</span><span class="l" id="143"> 143         <span class="php-comment">// --------- Pagination Attributes</span>
</span><span class="l" id="144"> 144         <span class="php-var">$this</span>-&gt;pager = <span class="php-keyword1">new</span> rex_pager(<span class="php-var">$rowsPerPage</span>);
</span><span class="l" id="145"> 145 
</span><span class="l" id="146"> 146         <span class="php-comment">// --------- Load Data, Row-Count</span>
</span><span class="l" id="147"> 147         <span class="php-var">$this</span>-&gt;sql-&gt;setQuery(<span class="php-var">$this</span>-&gt;prepareQuery(<span class="php-var">$query</span>));
</span><span class="l" id="148"> 148         <span class="php-var">$sql</span> = rex_sql::factory();
</span><span class="l" id="149"> 149         <span class="php-var">$sql</span>-&gt;setQuery(<span class="php-quote">'SELECT FOUND_ROWS() as '</span>. <span class="php-var">$sql</span>-&gt;escapeIdentifier(<span class="php-quote">'rows'</span>));
</span><span class="l" id="150"> 150         <span class="php-var">$this</span>-&gt;rows = <span class="php-var">$sql</span>-&gt;getValue(<span class="php-quote">'rows'</span>);
</span><span class="l" id="151"> 151         <span class="php-var">$this</span>-&gt;pager-&gt;setRowCount(<span class="php-var">$this</span>-&gt;rows);
</span><span class="l" id="152"> 152 
</span><span class="l" id="153"> 153         <span class="php-keyword1">foreach</span> (<span class="php-var">$this</span>-&gt;sql-&gt;getFieldnames() <span class="php-keyword1">as</span> <span class="php-var">$columnName</span>) {
</span><span class="l" id="154"> 154             <span class="php-var">$this</span>-&gt;columnNames[] = <span class="php-var">$columnName</span>;
</span><span class="l" id="155"> 155         }
</span><span class="l" id="156"> 156 
</span><span class="l" id="157"> 157         <span class="php-comment">// --------- Load Env</span>
</span><span class="l" id="158"> 158         <span class="php-keyword1">if</span> (rex::isBackend()) {
</span><span class="l" id="159"> 159             <span class="php-var">$this</span>-&gt;loadBackendConfig();
</span><span class="l" id="160"> 160         }
</span><span class="l" id="161"> 161 
</span><span class="l" id="162"> 162         <span class="php-var">$this</span>-&gt;init();
</span><span class="l" id="163"> 163     }
</span><span class="l" id="164"> 164 
</span><span class="l" id="165"> 165     <span class="php-comment">/**
</span></span><span class="l" id="166"> 166 <span class="php-comment">     * @param string $query
</span></span><span class="l" id="167"> 167 <span class="php-comment">     * @param int    $rowsPerPage
</span></span><span class="l" id="168"> 168 <span class="php-comment">     * @param null   $listName
</span></span><span class="l" id="169"> 169 <span class="php-comment">     * @param bool   $debug
</span></span><span class="l" id="170"> 170 <span class="php-comment">     *
</span></span><span class="l" id="171"> 171 <span class="php-comment">     * @return static
</span></span><span class="l" id="172"> 172 <span class="php-comment">     */</span>
</span><span class="l" id="173"> 173     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> factory(<span class="php-var">$query</span>, <span class="php-var">$rowsPerPage</span> = <span class="php-num">30</span>, <span class="php-var">$listName</span> = <span class="php-keyword1">null</span>, <span class="php-var">$debug</span> = <span class="php-keyword1">false</span>)
</span><span class="l" id="174"> 174     {
</span><span class="l" id="175"> 175         <span class="php-var">$class</span> = <span class="php-keyword1">static</span>::getFactoryClass();
</span><span class="l" id="176"> 176         <span class="php-keyword1">return</span> <span class="php-keyword1">new</span> <span class="php-var">$class</span>(<span class="php-var">$query</span>, <span class="php-var">$rowsPerPage</span>, <span class="php-var">$listName</span>, <span class="php-var">$debug</span>);
</span><span class="l" id="177"> 177     }
</span><span class="l" id="178"> 178 
</span><span class="l" id="179"> 179     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> init()
</span><span class="l" id="180"> 180     {
</span><span class="l" id="181"> 181         <span class="php-comment">// nichts tun</span>
</span><span class="l" id="182"> 182     }
</span><span class="l" id="183"> 183 
</span><span class="l" id="184"> 184     <span class="php-comment">// ---------------------- setters/getters</span>
</span><span class="l" id="185"> 185 
</span><span class="l" id="186"> 186     <span class="php-comment">/**
</span></span><span class="l" id="187"> 187 <span class="php-comment">     * Gibt den Namen es Formulars zurück.
</span></span><span class="l" id="188"> 188 <span class="php-comment">     *
</span></span><span class="l" id="189"> 189 <span class="php-comment">     * @return string
</span></span><span class="l" id="190"> 190 <span class="php-comment">     */</span>
</span><span class="l" id="191"> 191     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getName()
</span><span class="l" id="192"> 192     {
</span><span class="l" id="193"> 193         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;name;
</span><span class="l" id="194"> 194     }
</span><span class="l" id="195"> 195 
</span><span class="l" id="196"> 196     <span class="php-comment">/**
</span></span><span class="l" id="197"> 197 <span class="php-comment">     * Gibt eine Status Nachricht zurück.
</span></span><span class="l" id="198"> 198 <span class="php-comment">     *
</span></span><span class="l" id="199"> 199 <span class="php-comment">     * @return string
</span></span><span class="l" id="200"> 200 <span class="php-comment">     */</span>
</span><span class="l" id="201"> 201     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getMessage()
</span><span class="l" id="202"> 202     {
</span><span class="l" id="203"> 203         <span class="php-keyword1">return</span> <span class="php-keyword2">htmlspecialchars</span>(rex_request(<span class="php-var">$this</span>-&gt;getName() . <span class="php-quote">'_msg'</span>, <span class="php-quote">'string'</span>));
</span><span class="l" id="204"> 204     }
</span><span class="l" id="205"> 205 
</span><span class="l" id="206"> 206     <span class="php-comment">/**
</span></span><span class="l" id="207"> 207 <span class="php-comment">     * Gibt eine Warnung zurück.
</span></span><span class="l" id="208"> 208 <span class="php-comment">     *
</span></span><span class="l" id="209"> 209 <span class="php-comment">     * @return string
</span></span><span class="l" id="210"> 210 <span class="php-comment">     */</span>
</span><span class="l" id="211"> 211     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getWarning()
</span><span class="l" id="212"> 212     {
</span><span class="l" id="213"> 213         <span class="php-keyword1">return</span> <span class="php-keyword2">htmlspecialchars</span>(rex_request(<span class="php-var">$this</span>-&gt;getName() . <span class="php-quote">'_warning'</span>, <span class="php-quote">'string'</span>));
</span><span class="l" id="214"> 214     }
</span><span class="l" id="215"> 215 
</span><span class="l" id="216"> 216     <span class="php-comment">/**
</span></span><span class="l" id="217"> 217 <span class="php-comment">     * Setzt die Caption/den Titel der Tabelle
</span></span><span class="l" id="218"> 218 <span class="php-comment">     * Gibt den Namen es Formulars zurück.
</span></span><span class="l" id="219"> 219 <span class="php-comment">     *
</span></span><span class="l" id="220"> 220 <span class="php-comment">     * @param string $caption Caption/Titel der Tabelle
</span></span><span class="l" id="221"> 221 <span class="php-comment">     */</span>
</span><span class="l" id="222"> 222     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> setCaption(<span class="php-var">$caption</span>)
</span><span class="l" id="223"> 223     {
</span><span class="l" id="224"> 224         <span class="php-var">$this</span>-&gt;caption = <span class="php-var">$caption</span>;
</span><span class="l" id="225"> 225     }
</span><span class="l" id="226"> 226 
</span><span class="l" id="227"> 227     <span class="php-comment">/**
</span></span><span class="l" id="228"> 228 <span class="php-comment">     * Gibt die Caption/den Titel der Tabelle zurück.
</span></span><span class="l" id="229"> 229 <span class="php-comment">     *
</span></span><span class="l" id="230"> 230 <span class="php-comment">     * @return string
</span></span><span class="l" id="231"> 231 <span class="php-comment">     */</span>
</span><span class="l" id="232"> 232     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getCaption()
</span><span class="l" id="233"> 233     {
</span><span class="l" id="234"> 234         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;caption;
</span><span class="l" id="235"> 235     }
</span><span class="l" id="236"> 236 
</span><span class="l" id="237"> 237     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> setNoRowsMessage(<span class="php-var">$msg</span>)
</span><span class="l" id="238"> 238     {
</span><span class="l" id="239"> 239         <span class="php-var">$this</span>-&gt;noRowsMessage = <span class="php-var">$msg</span>;
</span><span class="l" id="240"> 240     }
</span><span class="l" id="241"> 241 
</span><span class="l" id="242"> 242     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getNoRowsMessage()
</span><span class="l" id="243"> 243     {
</span><span class="l" id="244"> 244         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;noRowsMessage;
</span><span class="l" id="245"> 245     }
</span><span class="l" id="246"> 246 
</span><span class="l" id="247"> 247     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> addParam(<span class="php-var">$name</span>, <span class="php-var">$value</span>)
</span><span class="l" id="248"> 248     {
</span><span class="l" id="249"> 249         <span class="php-var">$this</span>-&gt;params[<span class="php-var">$name</span>] = <span class="php-var">$value</span>;
</span><span class="l" id="250"> 250     }
</span><span class="l" id="251"> 251 
</span><span class="l" id="252"> 252     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getParams()
</span><span class="l" id="253"> 253     {
</span><span class="l" id="254"> 254         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;params;
</span><span class="l" id="255"> 255     }
</span><span class="l" id="256"> 256 
</span><span class="l" id="257"> 257     <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> loadBackendConfig()
</span><span class="l" id="258"> 258     {
</span><span class="l" id="259"> 259         <span class="php-var">$this</span>-&gt;addParam(<span class="php-quote">'page'</span>, rex_be_controller::getCurrentPage());
</span><span class="l" id="260"> 260     }
</span><span class="l" id="261"> 261 
</span><span class="l" id="262"> 262     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> addTableAttribute(<span class="php-var">$attrName</span>, <span class="php-var">$attrValue</span>)
</span><span class="l" id="263"> 263     {
</span><span class="l" id="264"> 264         <span class="php-var">$this</span>-&gt;tableAttributes[<span class="php-var">$attrName</span>] = <span class="php-var">$attrValue</span>;
</span><span class="l" id="265"> 265     }
</span><span class="l" id="266"> 266 
</span><span class="l" id="267"> 267     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getTableAttributes()
</span><span class="l" id="268"> 268     {
</span><span class="l" id="269"> 269         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;tableAttributes;
</span><span class="l" id="270"> 270     }
</span><span class="l" id="271"> 271 
</span><span class="l" id="272"> 272     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> addFormAttribute(<span class="php-var">$attrName</span>, <span class="php-var">$attrValue</span>)
</span><span class="l" id="273"> 273     {
</span><span class="l" id="274"> 274         <span class="php-var">$this</span>-&gt;formAttributes[<span class="php-var">$attrName</span>] = <span class="php-var">$attrValue</span>;
</span><span class="l" id="275"> 275     }
</span><span class="l" id="276"> 276 
</span><span class="l" id="277"> 277     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getFormAttributes()
</span><span class="l" id="278"> 278     {
</span><span class="l" id="279"> 279         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;formAttributes;
</span><span class="l" id="280"> 280     }
</span><span class="l" id="281"> 281 
</span><span class="l" id="282"> 282     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> addLinkAttribute(<span class="php-var">$columnName</span>, <span class="php-var">$attrName</span>, <span class="php-var">$attrValue</span>)
</span><span class="l" id="283"> 283     {
</span><span class="l" id="284"> 284         <span class="php-var">$this</span>-&gt;linkAttributes[<span class="php-var">$columnName</span>][<span class="php-var">$attrName</span>] = <span class="php-var">$attrValue</span>;
</span><span class="l" id="285"> 285     }
</span><span class="l" id="286"> 286 
</span><span class="l" id="287"> 287     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getLinkAttributes(<span class="php-var">$column</span>, <span class="php-var">$default</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="288"> 288     {
</span><span class="l" id="289"> 289         <span class="php-keyword1">return</span> <span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;linkAttributes[<span class="php-var">$column</span>]) ? <span class="php-var">$this</span>-&gt;linkAttributes[<span class="php-var">$column</span>] : <span class="php-var">$default</span>;
</span><span class="l" id="290"> 290     }
</span><span class="l" id="291"> 291 
</span><span class="l" id="292"> 292     <span class="php-comment">// ---------------------- Column setters/getters/etc</span>
</span><span class="l" id="293"> 293 
</span><span class="l" id="294"> 294     <span class="php-comment">/**
</span></span><span class="l" id="295"> 295 <span class="php-comment">     * Methode, um eine Spalte einzufügen.
</span></span><span class="l" id="296"> 296 <span class="php-comment">     *
</span></span><span class="l" id="297"> 297 <span class="php-comment">     * @param string $columnHead   Titel der Spalte
</span></span><span class="l" id="298"> 298 <span class="php-comment">     * @param string $columnBody   Text/Format der Spalte
</span></span><span class="l" id="299"> 299 <span class="php-comment">     * @param int    $columnIndex  Stelle, an der die neue Spalte erscheinen soll
</span></span><span class="l" id="300"> 300 <span class="php-comment">     * @param array  $columnLayout Layout der Spalte
</span></span><span class="l" id="301"> 301 <span class="php-comment">     */</span>
</span><span class="l" id="302"> 302     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> addColumn(<span class="php-var">$columnHead</span>, <span class="php-var">$columnBody</span>, <span class="php-var">$columnIndex</span> = -<span class="php-num">1</span>, <span class="php-var">$columnLayout</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="303"> 303     {
</span><span class="l" id="304"> 304         <span class="php-comment">// Bei negativem columnIndex, das Element am Ende anfügen</span>
</span><span class="l" id="305"> 305         <span class="php-keyword1">if</span> (<span class="php-var">$columnIndex</span> &lt; <span class="php-num">0</span>) {
</span><span class="l" id="306"> 306             <span class="php-var">$columnIndex</span> = <span class="php-keyword2">count</span>(<span class="php-var">$this</span>-&gt;columnNames);
</span><span class="l" id="307"> 307         }
</span><span class="l" id="308"> 308 
</span><span class="l" id="309"> 309         <span class="php-keyword2">array_splice</span>(<span class="php-var">$this</span>-&gt;columnNames, <span class="php-var">$columnIndex</span>, <span class="php-num">0</span>, [<span class="php-var">$columnHead</span>]);
</span><span class="l" id="310"> 310         <span class="php-var">$this</span>-&gt;customColumns[<span class="php-var">$columnHead</span>] = <span class="php-var">$columnBody</span>;
</span><span class="l" id="311"> 311         <span class="php-var">$this</span>-&gt;setColumnLayout(<span class="php-var">$columnHead</span>, <span class="php-var">$columnLayout</span>);
</span><span class="l" id="312"> 312     }
</span><span class="l" id="313"> 313 
</span><span class="l" id="314"> 314     <span class="php-comment">/**
</span></span><span class="l" id="315"> 315 <span class="php-comment">     * Entfernt eine Spalte aus der Anzeige.
</span></span><span class="l" id="316"> 316 <span class="php-comment">     *
</span></span><span class="l" id="317"> 317 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="318"> 318 <span class="php-comment">     */</span>
</span><span class="l" id="319"> 319     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> removeColumn(<span class="php-var">$columnName</span>)
</span><span class="l" id="320"> 320     {
</span><span class="l" id="321"> 321         <span class="php-var">$this</span>-&gt;columnDisabled[] = <span class="php-var">$columnName</span>;
</span><span class="l" id="322"> 322     }
</span><span class="l" id="323"> 323 
</span><span class="l" id="324"> 324     <span class="php-comment">/**
</span></span><span class="l" id="325"> 325 <span class="php-comment">     * Methode, um das Layout einer Spalte zu setzen.
</span></span><span class="l" id="326"> 326 <span class="php-comment">     *
</span></span><span class="l" id="327"> 327 <span class="php-comment">     * @param string $columnHead   Titel der Spalte
</span></span><span class="l" id="328"> 328 <span class="php-comment">     * @param array  $columnLayout Layout der Spalte
</span></span><span class="l" id="329"> 329 <span class="php-comment">     */</span>
</span><span class="l" id="330"> 330     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> setColumnLayout(<span class="php-var">$columnHead</span>, <span class="php-var">$columnLayout</span>)
</span><span class="l" id="331"> 331     {
</span><span class="l" id="332"> 332         <span class="php-var">$this</span>-&gt;columnLayouts[<span class="php-var">$columnHead</span>] = <span class="php-var">$columnLayout</span>;
</span><span class="l" id="333"> 333     }
</span><span class="l" id="334"> 334 
</span><span class="l" id="335"> 335     <span class="php-comment">/**
</span></span><span class="l" id="336"> 336 <span class="php-comment">     * Gibt das Layout einer Spalte zurück.
</span></span><span class="l" id="337"> 337 <span class="php-comment">     *
</span></span><span class="l" id="338"> 338 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="339"> 339 <span class="php-comment">     *
</span></span><span class="l" id="340"> 340 <span class="php-comment">     * @return array
</span></span><span class="l" id="341"> 341 <span class="php-comment">     */</span>
</span><span class="l" id="342"> 342     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnLayout(<span class="php-var">$columnName</span>)
</span><span class="l" id="343"> 343     {
</span><span class="l" id="344"> 344         <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;columnLayouts[<span class="php-var">$columnName</span>]) &amp;&amp; <span class="php-keyword2">is_array</span>(<span class="php-var">$this</span>-&gt;columnLayouts[<span class="php-var">$columnName</span>])) {
</span><span class="l" id="345"> 345             <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;columnLayouts[<span class="php-var">$columnName</span>];
</span><span class="l" id="346"> 346         }
</span><span class="l" id="347"> 347 
</span><span class="l" id="348"> 348         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;defaultColumnLayout;
</span><span class="l" id="349"> 349     }
</span><span class="l" id="350"> 350 
</span><span class="l" id="351"> 351     <span class="php-comment">/**
</span></span><span class="l" id="352"> 352 <span class="php-comment">     * Gibt die Layouts aller Spalten zurück.
</span></span><span class="l" id="353"> 353 <span class="php-comment">     */</span>
</span><span class="l" id="354"> 354     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnLayouts()
</span><span class="l" id="355"> 355     {
</span><span class="l" id="356"> 356         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;columnLayouts;
</span><span class="l" id="357"> 357     }
</span><span class="l" id="358"> 358 
</span><span class="l" id="359"> 359     <span class="php-comment">/**
</span></span><span class="l" id="360"> 360 <span class="php-comment">     * Gibt den Namen einer Spalte zurück.
</span></span><span class="l" id="361"> 361 <span class="php-comment">     *
</span></span><span class="l" id="362"> 362 <span class="php-comment">     * @param int   $columnIndex Nummer der Spalte
</span></span><span class="l" id="363"> 363 <span class="php-comment">     * @param mixed $default     Defaultrückgabewert, falls keine Spalte mit der angegebenen Nummer vorhanden ist
</span></span><span class="l" id="364"> 364 <span class="php-comment">     *
</span></span><span class="l" id="365"> 365 <span class="php-comment">     * @return string|null
</span></span><span class="l" id="366"> 366 <span class="php-comment">     */</span>
</span><span class="l" id="367"> 367     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnName(<span class="php-var">$columnIndex</span>, <span class="php-var">$default</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="368"> 368     {
</span><span class="l" id="369"> 369         <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;columnNames[<span class="php-var">$columnIndex</span>])) {
</span><span class="l" id="370"> 370             <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;columnNames[<span class="php-var">$columnIndex</span>];
</span><span class="l" id="371"> 371         }
</span><span class="l" id="372"> 372 
</span><span class="l" id="373"> 373         <span class="php-keyword1">return</span> <span class="php-var">$default</span>;
</span><span class="l" id="374"> 374     }
</span><span class="l" id="375"> 375 
</span><span class="l" id="376"> 376     <span class="php-comment">/**
</span></span><span class="l" id="377"> 377 <span class="php-comment">     * Gibt alle Namen der Spalten als Array zurück.
</span></span><span class="l" id="378"> 378 <span class="php-comment">     *
</span></span><span class="l" id="379"> 379 <span class="php-comment">     * @return array
</span></span><span class="l" id="380"> 380 <span class="php-comment">     */</span>
</span><span class="l" id="381"> 381     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnNames()
</span><span class="l" id="382"> 382     {
</span><span class="l" id="383"> 383         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;columnNames;
</span><span class="l" id="384"> 384     }
</span><span class="l" id="385"> 385 
</span><span class="l" id="386"> 386     <span class="php-comment">/**
</span></span><span class="l" id="387"> 387 <span class="php-comment">     * Setzt ein Label für eine Spalte.
</span></span><span class="l" id="388"> 388 <span class="php-comment">     *
</span></span><span class="l" id="389"> 389 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="390"> 390 <span class="php-comment">     * @param string $label      Label für die Spalte
</span></span><span class="l" id="391"> 391 <span class="php-comment">     */</span>
</span><span class="l" id="392"> 392     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> setColumnLabel(<span class="php-var">$columnName</span>, <span class="php-var">$label</span>)
</span><span class="l" id="393"> 393     {
</span><span class="l" id="394"> 394         <span class="php-var">$this</span>-&gt;columnLabels[<span class="php-var">$columnName</span>] = <span class="php-var">$label</span>;
</span><span class="l" id="395"> 395     }
</span><span class="l" id="396"> 396 
</span><span class="l" id="397"> 397     <span class="php-comment">/**
</span></span><span class="l" id="398"> 398 <span class="php-comment">     * Gibt das Label der Spalte zurück, falls gesetzt.
</span></span><span class="l" id="399"> 399 <span class="php-comment">     *
</span></span><span class="l" id="400"> 400 <span class="php-comment">     * Falls nicht vorhanden und der Parameter $default auf null steht,
</span></span><span class="l" id="401"> 401 <span class="php-comment">     * wird der Spaltenname zurückgegeben
</span></span><span class="l" id="402"> 402 <span class="php-comment">     *
</span></span><span class="l" id="403"> 403 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="404"> 404 <span class="php-comment">     * @param mixed  $default    Defaultrückgabewert, falls kein Label gesetzt ist
</span></span><span class="l" id="405"> 405 <span class="php-comment">     *
</span></span><span class="l" id="406"> 406 <span class="php-comment">     * @return string|null
</span></span><span class="l" id="407"> 407 <span class="php-comment">     */</span>
</span><span class="l" id="408"> 408     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnLabel(<span class="php-var">$columnName</span>, <span class="php-var">$default</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="409"> 409     {
</span><span class="l" id="410"> 410         <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;columnLabels[<span class="php-var">$columnName</span>])) {
</span><span class="l" id="411"> 411             <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;columnLabels[<span class="php-var">$columnName</span>];
</span><span class="l" id="412"> 412         }
</span><span class="l" id="413"> 413 
</span><span class="l" id="414"> 414         <span class="php-keyword1">return</span> <span class="php-var">$default</span> === <span class="php-keyword1">null</span> ? <span class="php-var">$columnName</span> : <span class="php-var">$default</span>;
</span><span class="l" id="415"> 415     }
</span><span class="l" id="416"> 416 
</span><span class="l" id="417"> 417     <span class="php-comment">/**
</span></span><span class="l" id="418"> 418 <span class="php-comment">     * Setzt ein Format für die Spalte.
</span></span><span class="l" id="419"> 419 <span class="php-comment">     *
</span></span><span class="l" id="420"> 420 <span class="php-comment">     * @param string $columnName  Name der Spalte
</span></span><span class="l" id="421"> 421 <span class="php-comment">     * @param string $format_type Formatierungstyp
</span></span><span class="l" id="422"> 422 <span class="php-comment">     * @param mixed  $format      Zu verwendentes Format
</span></span><span class="l" id="423"> 423 <span class="php-comment">     * @param array  $params      Custom params für callback func bei format_type 'custom'
</span></span><span class="l" id="424"> 424 <span class="php-comment">     */</span>
</span><span class="l" id="425"> 425     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> setColumnFormat(<span class="php-var">$columnName</span>, <span class="php-var">$format_type</span>, <span class="php-var">$format</span> = <span class="php-quote">''</span>, <span class="php-keyword1">array</span> <span class="php-var">$params</span> = [])
</span><span class="l" id="426"> 426     {
</span><span class="l" id="427"> 427         <span class="php-var">$this</span>-&gt;columnFormates[<span class="php-var">$columnName</span>] = [<span class="php-var">$format_type</span>, <span class="php-var">$format</span>, <span class="php-var">$params</span>];
</span><span class="l" id="428"> 428     }
</span><span class="l" id="429"> 429 
</span><span class="l" id="430"> 430     <span class="php-comment">/**
</span></span><span class="l" id="431"> 431 <span class="php-comment">     * Gibt das Format für eine Spalte zurück.
</span></span><span class="l" id="432"> 432 <span class="php-comment">     *
</span></span><span class="l" id="433"> 433 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="434"> 434 <span class="php-comment">     * @param mixed  $default    Defaultrückgabewert, falls keine Formatierung gesetzt ist
</span></span><span class="l" id="435"> 435 <span class="php-comment">     *
</span></span><span class="l" id="436"> 436 <span class="php-comment">     * @return string|null
</span></span><span class="l" id="437"> 437 <span class="php-comment">     */</span>
</span><span class="l" id="438"> 438     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnFormat(<span class="php-var">$columnName</span>, <span class="php-var">$default</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="439"> 439     {
</span><span class="l" id="440"> 440         <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;columnFormates[<span class="php-var">$columnName</span>])) {
</span><span class="l" id="441"> 441             <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;columnFormates[<span class="php-var">$columnName</span>];
</span><span class="l" id="442"> 442         }
</span><span class="l" id="443"> 443 
</span><span class="l" id="444"> 444         <span class="php-keyword1">return</span> <span class="php-var">$default</span>;
</span><span class="l" id="445"> 445     }
</span><span class="l" id="446"> 446 
</span><span class="l" id="447"> 447     <span class="php-comment">/**
</span></span><span class="l" id="448"> 448 <span class="php-comment">     * Markiert eine Spalte als sortierbar.
</span></span><span class="l" id="449"> 449 <span class="php-comment">     *
</span></span><span class="l" id="450"> 450 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="451"> 451 <span class="php-comment">     * @param string $direction  Startsortierrichtung der Spalte [ASC|DESC]
</span></span><span class="l" id="452"> 452 <span class="php-comment">     */</span>
</span><span class="l" id="453"> 453     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> setColumnSortable(<span class="php-var">$columnName</span>, <span class="php-var">$direction</span> = <span class="php-quote">'asc'</span>)
</span><span class="l" id="454"> 454     {
</span><span class="l" id="455"> 455         <span class="php-var">$this</span>-&gt;setColumnOption(<span class="php-var">$columnName</span>, REX_LIST_OPT_SORT, <span class="php-keyword1">true</span>);
</span><span class="l" id="456"> 456         <span class="php-var">$this</span>-&gt;setColumnOption(<span class="php-var">$columnName</span>, REX_LIST_OPT_SORT_DIRECTION, <span class="php-keyword2">strtolower</span>(<span class="php-var">$direction</span>));
</span><span class="l" id="457"> 457     }
</span><span class="l" id="458"> 458 
</span><span class="l" id="459"> 459     <span class="php-comment">/**
</span></span><span class="l" id="460"> 460 <span class="php-comment">     * Setzt eine Option für eine Spalte
</span></span><span class="l" id="461"> 461 <span class="php-comment">     * (z.b. Sortable,..).
</span></span><span class="l" id="462"> 462 <span class="php-comment">     *
</span></span><span class="l" id="463"> 463 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="464"> 464 <span class="php-comment">     * @param string $option     Name/Id der Option
</span></span><span class="l" id="465"> 465 <span class="php-comment">     * @param mixed  $value      Wert der Option
</span></span><span class="l" id="466"> 466 <span class="php-comment">     */</span>
</span><span class="l" id="467"> 467     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> setColumnOption(<span class="php-var">$columnName</span>, <span class="php-var">$option</span>, <span class="php-var">$value</span>)
</span><span class="l" id="468"> 468     {
</span><span class="l" id="469"> 469         <span class="php-var">$this</span>-&gt;columnOptions[<span class="php-var">$columnName</span>][<span class="php-var">$option</span>] = <span class="php-var">$value</span>;
</span><span class="l" id="470"> 470     }
</span><span class="l" id="471"> 471 
</span><span class="l" id="472"> 472     <span class="php-comment">/**
</span></span><span class="l" id="473"> 473 <span class="php-comment">     * Gibt den Wert einer Option für eine Spalte zurück.
</span></span><span class="l" id="474"> 474 <span class="php-comment">     *
</span></span><span class="l" id="475"> 475 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="476"> 476 <span class="php-comment">     * @param string $option     Name/Id der Option
</span></span><span class="l" id="477"> 477 <span class="php-comment">     * @param mixed  $default    Defaultrückgabewert, falls die Option nicht gesetzt ist
</span></span><span class="l" id="478"> 478 <span class="php-comment">     *
</span></span><span class="l" id="479"> 479 <span class="php-comment">     * @return mixed|null
</span></span><span class="l" id="480"> 480 <span class="php-comment">     */</span>
</span><span class="l" id="481"> 481     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnOption(<span class="php-var">$columnName</span>, <span class="php-var">$option</span>, <span class="php-var">$default</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="482"> 482     {
</span><span class="l" id="483"> 483         <span class="php-keyword1">if</span> (<span class="php-var">$this</span>-&gt;hasColumnOption(<span class="php-var">$columnName</span>, <span class="php-var">$option</span>)) {
</span><span class="l" id="484"> 484             <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;columnOptions[<span class="php-var">$columnName</span>][<span class="php-var">$option</span>];
</span><span class="l" id="485"> 485         }
</span><span class="l" id="486"> 486         <span class="php-keyword1">return</span> <span class="php-var">$default</span>;
</span><span class="l" id="487"> 487     }
</span><span class="l" id="488"> 488 
</span><span class="l" id="489"> 489     <span class="php-comment">/**
</span></span><span class="l" id="490"> 490 <span class="php-comment">     * Gibt zurück, ob für eine Spalte eine Option gesetzt wurde.
</span></span><span class="l" id="491"> 491 <span class="php-comment">     *
</span></span><span class="l" id="492"> 492 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="493"> 493 <span class="php-comment">     * @param string $option     Name/Id der Option
</span></span><span class="l" id="494"> 494 <span class="php-comment">     *
</span></span><span class="l" id="495"> 495 <span class="php-comment">     * @return bool
</span></span><span class="l" id="496"> 496 <span class="php-comment">     */</span>
</span><span class="l" id="497"> 497     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> hasColumnOption(<span class="php-var">$columnName</span>, <span class="php-var">$option</span>)
</span><span class="l" id="498"> 498     {
</span><span class="l" id="499"> 499         <span class="php-keyword1">return</span> <span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;columnOptions[<span class="php-var">$columnName</span>][<span class="php-var">$option</span>]);
</span><span class="l" id="500"> 500     }
</span><span class="l" id="501"> 501 
</span><span class="l" id="502"> 502     <span class="php-comment">/**
</span></span><span class="l" id="503"> 503 <span class="php-comment">     * Verlinkt eine Spalte mit den übergebenen Parametern.
</span></span><span class="l" id="504"> 504 <span class="php-comment">     *
</span></span><span class="l" id="505"> 505 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="506"> 506 <span class="php-comment">     * @param array  $params     Array von Parametern
</span></span><span class="l" id="507"> 507 <span class="php-comment">     */</span>
</span><span class="l" id="508"> 508     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> setColumnParams(<span class="php-var">$columnName</span>, <span class="php-keyword1">array</span> <span class="php-var">$params</span> = [])
</span><span class="l" id="509"> 509     {
</span><span class="l" id="510"> 510         <span class="php-var">$this</span>-&gt;columnParams[<span class="php-var">$columnName</span>] = <span class="php-var">$params</span>;
</span><span class="l" id="511"> 511     }
</span><span class="l" id="512"> 512 
</span><span class="l" id="513"> 513     <span class="php-comment">/**
</span></span><span class="l" id="514"> 514 <span class="php-comment">     * Gibt die Parameter für eine Spalte zurück.
</span></span><span class="l" id="515"> 515 <span class="php-comment">     *
</span></span><span class="l" id="516"> 516 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="517"> 517 <span class="php-comment">     *
</span></span><span class="l" id="518"> 518 <span class="php-comment">     * @return array
</span></span><span class="l" id="519"> 519 <span class="php-comment">     */</span>
</span><span class="l" id="520"> 520     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnParams(<span class="php-var">$columnName</span>)
</span><span class="l" id="521"> 521     {
</span><span class="l" id="522"> 522         <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;columnParams[<span class="php-var">$columnName</span>]) &amp;&amp; <span class="php-keyword2">is_array</span>(<span class="php-var">$this</span>-&gt;columnParams[<span class="php-var">$columnName</span>])) {
</span><span class="l" id="523"> 523             <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;columnParams[<span class="php-var">$columnName</span>];
</span><span class="l" id="524"> 524         }
</span><span class="l" id="525"> 525         <span class="php-keyword1">return</span> [];
</span><span class="l" id="526"> 526     }
</span><span class="l" id="527"> 527 
</span><span class="l" id="528"> 528     <span class="php-comment">/**
</span></span><span class="l" id="529"> 529 <span class="php-comment">     * Gibt zurück, ob Parameter für eine Spalte existieren.
</span></span><span class="l" id="530"> 530 <span class="php-comment">     *
</span></span><span class="l" id="531"> 531 <span class="php-comment">     * @param string $columnName Name der Spalte
</span></span><span class="l" id="532"> 532 <span class="php-comment">     *
</span></span><span class="l" id="533"> 533 <span class="php-comment">     * @return bool
</span></span><span class="l" id="534"> 534 <span class="php-comment">     */</span>
</span><span class="l" id="535"> 535     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> hasColumnParams(<span class="php-var">$columnName</span>)
</span><span class="l" id="536"> 536     {
</span><span class="l" id="537"> 537         <span class="php-keyword1">return</span> <span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;columnParams[<span class="php-var">$columnName</span>]) &amp;&amp; <span class="php-keyword2">is_array</span>(<span class="php-var">$this</span>-&gt;columnParams[<span class="php-var">$columnName</span>]) &amp;&amp; <span class="php-keyword2">count</span>(<span class="php-var">$this</span>-&gt;columnParams[<span class="php-var">$columnName</span>]) &gt; <span class="php-num">0</span>;
</span><span class="l" id="538"> 538     }
</span><span class="l" id="539"> 539 
</span><span class="l" id="540"> 540     <span class="php-comment">// ---------------------- TableColumnGroup setters/getters/etc</span>
</span><span class="l" id="541"> 541 
</span><span class="l" id="542"> 542     <span class="php-comment">/**
</span></span><span class="l" id="543"> 543 <span class="php-comment">     * Methode um eine Colgroup einzufügen.
</span></span><span class="l" id="544"> 544 <span class="php-comment">     *
</span></span><span class="l" id="545"> 545 <span class="php-comment">     * Beispiel 1:
</span></span><span class="l" id="546"> 546 <span class="php-comment">     *
</span></span><span class="l" id="547"> 547 <span class="php-comment">     * $list-&gt;addTableColumnGroup([40, '*', 240, 140]);
</span></span><span class="l" id="548"> 548 <span class="php-comment">     *
</span></span><span class="l" id="549"> 549 <span class="php-comment">     * Beispiel 2:
</span></span><span class="l" id="550"> 550 <span class="php-comment">     *
</span></span><span class="l" id="551"> 551 <span class="php-comment">     * $list-&gt;addTableColumnGroup([
</span></span><span class="l" id="552"> 552 <span class="php-comment">     *     ['width' =&gt; 40],
</span></span><span class="l" id="553"> 553 <span class="php-comment">     *     ['width' =&gt; 140, 'span' =&gt; 2],
</span></span><span class="l" id="554"> 554 <span class="php-comment">     *     ['width' =&gt; 240]
</span></span><span class="l" id="555"> 555 <span class="php-comment">     * ]);
</span></span><span class="l" id="556"> 556 <span class="php-comment">     *
</span></span><span class="l" id="557"> 557 <span class="php-comment">     * Beispiel 3:
</span></span><span class="l" id="558"> 558 <span class="php-comment">     *
</span></span><span class="l" id="559"> 559 <span class="php-comment">     * $list-&gt;addTableColumnGroup([
</span></span><span class="l" id="560"> 560 <span class="php-comment">     *     ['class' =&gt; 'classname-a'],
</span></span><span class="l" id="561"> 561 <span class="php-comment">     *     ['class' =&gt; 'classname-b'],
</span></span><span class="l" id="562"> 562 <span class="php-comment">     *     ['class' =&gt; 'classname-c']
</span></span><span class="l" id="563"> 563 <span class="php-comment">     * ]);
</span></span><span class="l" id="564"> 564 <span class="php-comment">     *
</span></span><span class="l" id="565"> 565 <span class="php-comment">     * @param array $columns         Array von Spalten
</span></span><span class="l" id="566"> 566 <span class="php-comment">     * @param int   $columnGroupSpan Span der Columngroup
</span></span><span class="l" id="567"> 567 <span class="php-comment">     */</span>
</span><span class="l" id="568"> 568     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> addTableColumnGroup(<span class="php-keyword1">array</span> <span class="php-var">$columns</span>, <span class="php-var">$columnGroupSpan</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="569"> 569     {
</span><span class="l" id="570"> 570         <span class="php-var">$tableColumnGroup</span> = [<span class="php-quote">'columns'</span> =&gt; []];
</span><span class="l" id="571"> 571         <span class="php-keyword1">if</span> (<span class="php-var">$columnGroupSpan</span>) {
</span><span class="l" id="572"> 572             <span class="php-var">$tableColumnGroup</span>[<span class="php-quote">'span'</span>] = <span class="php-var">$columnGroupSpan</span>;
</span><span class="l" id="573"> 573         }
</span><span class="l" id="574"> 574         <span class="php-var">$this</span>-&gt;tableColumnGroups[] = <span class="php-var">$tableColumnGroup</span>;
</span><span class="l" id="575"> 575 
</span><span class="l" id="576"> 576         <span class="php-keyword1">foreach</span> (<span class="php-var">$columns</span> <span class="php-keyword1">as</span> <span class="php-var">$column</span>) {
</span><span class="l" id="577"> 577             <span class="php-keyword1">if</span> (<span class="php-keyword2">is_array</span>(<span class="php-var">$column</span>)) {
</span><span class="l" id="578"> 578                 <span class="php-var">$this</span>-&gt;addTableColumn(<span class="php-keyword1">isset</span>(<span class="php-var">$column</span>[<span class="php-quote">'width'</span>]) ? <span class="php-var">$column</span>[<span class="php-quote">'width'</span>] : <span class="php-keyword1">null</span>, <span class="php-keyword1">isset</span>(<span class="php-var">$column</span>[<span class="php-quote">'span'</span>]) ? <span class="php-var">$column</span>[<span class="php-quote">'span'</span>] : <span class="php-keyword1">null</span>, <span class="php-keyword1">isset</span>(<span class="php-var">$column</span>[<span class="php-quote">'class'</span>]) ? <span class="php-var">$column</span>[<span class="php-quote">'class'</span>] : <span class="php-keyword1">null</span>);
</span><span class="l" id="579"> 579             } <span class="php-keyword1">else</span> {
</span><span class="l" id="580"> 580                 <span class="php-var">$this</span>-&gt;addTableColumn(<span class="php-var">$column</span>);
</span><span class="l" id="581"> 581             }
</span><span class="l" id="582"> 582         }
</span><span class="l" id="583"> 583     }
</span><span class="l" id="584"> 584 
</span><span class="l" id="585"> 585     <span class="php-comment">/**
</span></span><span class="l" id="586"> 586 <span class="php-comment">     * @return array
</span></span><span class="l" id="587"> 587 <span class="php-comment">     */</span>
</span><span class="l" id="588"> 588     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getTableColumnGroups()
</span><span class="l" id="589"> 589     {
</span><span class="l" id="590"> 590         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;tableColumnGroups;
</span><span class="l" id="591"> 591     }
</span><span class="l" id="592"> 592 
</span><span class="l" id="593"> 593     <span class="php-comment">/**
</span></span><span class="l" id="594"> 594 <span class="php-comment">     * Fügt der zuletzte eingefügten TableColumnGroup eine weitere Spalte hinzu.
</span></span><span class="l" id="595"> 595 <span class="php-comment">     *
</span></span><span class="l" id="596"> 596 <span class="php-comment">     * @param int $width Breite der Spalte
</span></span><span class="l" id="597"> 597 <span class="php-comment">     * @param int $span  Span der Spalte
</span></span><span class="l" id="598"> 598 <span class="php-comment">     */</span>
</span><span class="l" id="599"> 599     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> addTableColumn(<span class="php-var">$width</span>, <span class="php-var">$span</span> = <span class="php-keyword1">null</span>, <span class="php-var">$class</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="600"> 600     {
</span><span class="l" id="601"> 601         <span class="php-var">$tableColumn</span> = [];
</span><span class="l" id="602"> 602         <span class="php-keyword1">if</span> (<span class="php-keyword2">is_numeric</span>(<span class="php-var">$width</span>)) {
</span><span class="l" id="603"> 603             <span class="php-var">$width</span> = <span class="php-var">$width</span> . <span class="php-quote">'px'</span>;
</span><span class="l" id="604"> 604         }
</span><span class="l" id="605"> 605         <span class="php-keyword1">if</span> (<span class="php-var">$width</span> &amp;&amp; <span class="php-quote">'*'</span> != <span class="php-var">$width</span>) {
</span><span class="l" id="606"> 606             <span class="php-var">$tableColumn</span>[<span class="php-quote">'style'</span>] = <span class="php-quote">'width:'</span> . <span class="php-var">$width</span>;
</span><span class="l" id="607"> 607         }
</span><span class="l" id="608"> 608         <span class="php-keyword1">if</span> (<span class="php-var">$span</span>) {
</span><span class="l" id="609"> 609             <span class="php-var">$tableColumn</span>[<span class="php-quote">'span'</span>] = <span class="php-var">$span</span>;
</span><span class="l" id="610"> 610         }
</span><span class="l" id="611"> 611         <span class="php-keyword1">if</span> (<span class="php-var">$class</span>) {
</span><span class="l" id="612"> 612             <span class="php-var">$tableColumn</span>[<span class="php-quote">'class'</span>] = <span class="php-var">$class</span>;
</span><span class="l" id="613"> 613         }
</span><span class="l" id="614"> 614 
</span><span class="l" id="615"> 615         <span class="php-var">$lastIndex</span> = <span class="php-keyword2">count</span>(<span class="php-var">$this</span>-&gt;tableColumnGroups) - <span class="php-num">1</span>;
</span><span class="l" id="616"> 616 
</span><span class="l" id="617"> 617         <span class="php-keyword1">if</span> (<span class="php-var">$lastIndex</span> &lt; <span class="php-num">0</span>) {
</span><span class="l" id="618"> 618             <span class="php-comment">// Falls noch keine TableColumnGroup vorhanden, eine leere anlegen!</span>
</span><span class="l" id="619"> 619             <span class="php-var">$this</span>-&gt;addTableColumnGroup([]);
</span><span class="l" id="620"> 620             ++<span class="php-var">$lastIndex</span>;
</span><span class="l" id="621"> 621         }
</span><span class="l" id="622"> 622 
</span><span class="l" id="623"> 623         <span class="php-var">$groupColumns</span> = <span class="php-var">$this</span>-&gt;tableColumnGroups[<span class="php-var">$lastIndex</span>][<span class="php-quote">'columns'</span>];
</span><span class="l" id="624"> 624         <span class="php-var">$groupColumns</span>[] = <span class="php-var">$tableColumn</span>;
</span><span class="l" id="625"> 625         <span class="php-var">$this</span>-&gt;tableColumnGroups[<span class="php-var">$lastIndex</span>][<span class="php-quote">'columns'</span>] = <span class="php-var">$groupColumns</span>;
</span><span class="l" id="626"> 626     }
</span><span class="l" id="627"> 627 
</span><span class="l" id="628"> 628     <span class="php-comment">// ---------------------- Url generation</span>
</span><span class="l" id="629"> 629 
</span><span class="l" id="630"> 630     <span class="php-comment">/**
</span></span><span class="l" id="631"> 631 <span class="php-comment">     * {@inheritdoc}
</span></span><span class="l" id="632"> 632 <span class="php-comment">     */</span>
</span><span class="l" id="633"> 633     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getUrl(<span class="php-keyword1">array</span> <span class="php-var">$params</span> = [], <span class="php-var">$escape</span> = <span class="php-keyword1">true</span>)
</span><span class="l" id="634"> 634     {
</span><span class="l" id="635"> 635         <span class="php-var">$params</span> = <span class="php-keyword2">array_merge</span>(<span class="php-var">$this</span>-&gt;getParams(), <span class="php-var">$params</span>);
</span><span class="l" id="636"> 636 
</span><span class="l" id="637"> 637         <span class="php-var">$params</span>[<span class="php-quote">'list'</span>] = <span class="php-var">$this</span>-&gt;getName();
</span><span class="l" id="638"> 638 
</span><span class="l" id="639"> 639         <span class="php-keyword1">if</span> (!<span class="php-keyword1">isset</span>(<span class="php-var">$params</span>[<span class="php-quote">'sort'</span>])) {
</span><span class="l" id="640"> 640             <span class="php-var">$sortColumn</span> = <span class="php-var">$this</span>-&gt;getSortColumn();
</span><span class="l" id="641"> 641             <span class="php-keyword1">if</span> (<span class="php-var">$sortColumn</span> != <span class="php-keyword1">null</span>) {
</span><span class="l" id="642"> 642                 <span class="php-var">$params</span>[<span class="php-quote">'sort'</span>] = <span class="php-var">$sortColumn</span>;
</span><span class="l" id="643"> 643                 <span class="php-var">$params</span>[<span class="php-quote">'sorttype'</span>] = <span class="php-var">$this</span>-&gt;getSortType();
</span><span class="l" id="644"> 644             }
</span><span class="l" id="645"> 645         }
</span><span class="l" id="646"> 646 
</span><span class="l" id="647"> 647         <span class="php-var">$_params</span> = [];
</span><span class="l" id="648"> 648         <span class="php-keyword1">foreach</span> (<span class="php-var">$params</span> <span class="php-keyword1">as</span> <span class="php-var">$name</span> =&gt; <span class="php-var">$value</span>) {
</span><span class="l" id="649"> 649             <span class="php-keyword1">if</span> (<span class="php-keyword2">is_array</span>(<span class="php-var">$value</span>)) {
</span><span class="l" id="650"> 650                 <span class="php-keyword1">foreach</span> (<span class="php-var">$value</span> <span class="php-keyword1">as</span> <span class="php-var">$v</span>) {
</span><span class="l" id="651"> 651                     <span class="php-var">$_params</span>[<span class="php-var">$name</span>] = <span class="php-var">$v</span>;
</span><span class="l" id="652"> 652                 }
</span><span class="l" id="653"> 653             } <span class="php-keyword1">else</span> {
</span><span class="l" id="654"> 654                 <span class="php-var">$_params</span>[<span class="php-var">$name</span>] = <span class="php-var">$value</span>;
</span><span class="l" id="655"> 655             }
</span><span class="l" id="656"> 656         }
</span><span class="l" id="657"> 657 
</span><span class="l" id="658"> 658         <span class="php-keyword1">return</span> rex::isBackend() ? rex_url::backendController(<span class="php-var">$_params</span>, <span class="php-var">$escape</span>) : rex_url::frontendController(<span class="php-var">$_params</span>, <span class="php-var">$escape</span>);
</span><span class="l" id="659"> 659     }
</span><span class="l" id="660"> 660 
</span><span class="l" id="661"> 661     <span class="php-comment">/**
</span></span><span class="l" id="662"> 662 <span class="php-comment">     * Gibt eine Url zurück, die die Parameter $params enthält
</span></span><span class="l" id="663"> 663 <span class="php-comment">     * Dieser Url werden die Standard rexList Variablen zugefügt.
</span></span><span class="l" id="664"> 664 <span class="php-comment">     *
</span></span><span class="l" id="665"> 665 <span class="php-comment">     * Innerhalb dieser Url werden variablen ersetzt
</span></span><span class="l" id="666"> 666 <span class="php-comment">     *
</span></span><span class="l" id="667"> 667 <span class="php-comment">     * @see #replaceVariable, #replaceVariables
</span></span><span class="l" id="668"> 668 <span class="php-comment">     *
</span></span><span class="l" id="669"> 669 <span class="php-comment">     * @param array $params
</span></span><span class="l" id="670"> 670 <span class="php-comment">     * @param bool  $escape Flag whether the argument separator "&amp;" should be escaped (&amp;amp;)
</span></span><span class="l" id="671"> 671 <span class="php-comment">     *
</span></span><span class="l" id="672"> 672 <span class="php-comment">     * @return string
</span></span><span class="l" id="673"> 673 <span class="php-comment">     */</span>
</span><span class="l" id="674"> 674     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getParsedUrl(<span class="php-var">$params</span> = [], <span class="php-var">$escape</span> = <span class="php-keyword1">true</span>)
</span><span class="l" id="675"> 675     {
</span><span class="l" id="676"> 676         <span class="php-var">$params</span> = <span class="php-keyword2">array_merge</span>(<span class="php-var">$this</span>-&gt;getParams(), <span class="php-var">$params</span>);
</span><span class="l" id="677"> 677 
</span><span class="l" id="678"> 678         <span class="php-var">$params</span>[<span class="php-quote">'list'</span>] = <span class="php-var">$this</span>-&gt;getName();
</span><span class="l" id="679"> 679 
</span><span class="l" id="680"> 680         <span class="php-keyword1">if</span> (!<span class="php-keyword1">isset</span>(<span class="php-var">$params</span>[<span class="php-quote">'sort'</span>])) {
</span><span class="l" id="681"> 681             <span class="php-var">$sortColumn</span> = <span class="php-var">$this</span>-&gt;getSortColumn();
</span><span class="l" id="682"> 682             <span class="php-keyword1">if</span> (<span class="php-var">$sortColumn</span> != <span class="php-keyword1">null</span>) {
</span><span class="l" id="683"> 683                 <span class="php-var">$params</span>[<span class="php-quote">'sort'</span>] = <span class="php-var">$sortColumn</span>;
</span><span class="l" id="684"> 684                 <span class="php-var">$params</span>[<span class="php-quote">'sorttype'</span>] = <span class="php-var">$this</span>-&gt;getSortType();
</span><span class="l" id="685"> 685             }
</span><span class="l" id="686"> 686         }
</span><span class="l" id="687"> 687 
</span><span class="l" id="688"> 688         <span class="php-var">$_params</span> = [];
</span><span class="l" id="689"> 689         <span class="php-keyword1">foreach</span> (<span class="php-var">$params</span> <span class="php-keyword1">as</span> <span class="php-var">$name</span> =&gt; <span class="php-var">$value</span>) {
</span><span class="l" id="690"> 690             <span class="php-keyword1">if</span> (<span class="php-keyword2">is_array</span>(<span class="php-var">$value</span>)) {
</span><span class="l" id="691"> 691                 <span class="php-keyword1">foreach</span> (<span class="php-var">$value</span> <span class="php-keyword1">as</span> <span class="php-var">$v</span>) {
</span><span class="l" id="692"> 692                     <span class="php-var">$_params</span>[<span class="php-var">$name</span>] = <span class="php-var">$this</span>-&gt;replaceVariables(<span class="php-var">$v</span>);
</span><span class="l" id="693"> 693                 }
</span><span class="l" id="694"> 694             } <span class="php-keyword1">else</span> {
</span><span class="l" id="695"> 695                 <span class="php-var">$_params</span>[<span class="php-var">$name</span>] = <span class="php-var">$this</span>-&gt;replaceVariables(<span class="php-var">$value</span>);
</span><span class="l" id="696"> 696             }
</span><span class="l" id="697"> 697         }
</span><span class="l" id="698"> 698         <span class="php-keyword1">return</span> rex::isBackend() ? rex_url::backendController(<span class="php-var">$_params</span>, <span class="php-var">$escape</span>) : rex_url::frontendController(<span class="php-var">$_params</span>, <span class="php-var">$escape</span>);
</span><span class="l" id="699"> 699     }
</span><span class="l" id="700"> 700 
</span><span class="l" id="701"> 701     <span class="php-comment">// ---------------------- Pagination</span>
</span><span class="l" id="702"> 702 
</span><span class="l" id="703"> 703     <span class="php-comment">/**
</span></span><span class="l" id="704"> 704 <span class="php-comment">     * Prepariert das SQL Statement vorm anzeigen der Liste.
</span></span><span class="l" id="705"> 705 <span class="php-comment">     *
</span></span><span class="l" id="706"> 706 <span class="php-comment">     * @param string $query SQL Statement
</span></span><span class="l" id="707"> 707 <span class="php-comment">     *
</span></span><span class="l" id="708"> 708 <span class="php-comment">     * @return string
</span></span><span class="l" id="709"> 709 <span class="php-comment">     */</span>
</span><span class="l" id="710"> 710     <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> prepareQuery(<span class="php-var">$query</span>)
</span><span class="l" id="711"> 711     {
</span><span class="l" id="712"> 712         <span class="php-var">$rowsPerPage</span> = <span class="php-var">$this</span>-&gt;pager-&gt;getRowsPerPage();
</span><span class="l" id="713"> 713         <span class="php-var">$startRow</span> = <span class="php-var">$this</span>-&gt;pager-&gt;getCursor();
</span><span class="l" id="714"> 714 
</span><span class="l" id="715"> 715         <span class="php-comment">// prepare query for fast rowcount calculation</span>
</span><span class="l" id="716"> 716         <span class="php-var">$query</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/^\s*SELECT/i'</span>, <span class="php-quote">'SELECT SQL_CALC_FOUND_ROWS'</span>, <span class="php-var">$query</span>, <span class="php-num">1</span>);
</span><span class="l" id="717"> 717 
</span><span class="l" id="718"> 718         <span class="php-var">$sortColumn</span> = <span class="php-var">$this</span>-&gt;getSortColumn();
</span><span class="l" id="719"> 719         <span class="php-keyword1">if</span> (<span class="php-var">$sortColumn</span> != <span class="php-quote">''</span>) {
</span><span class="l" id="720"> 720             <span class="php-var">$sortType</span> = <span class="php-var">$this</span>-&gt;getSortType();
</span><span class="l" id="721"> 721 
</span><span class="l" id="722"> 722             <span class="php-keyword1">if</span> (<span class="php-keyword2">stripos</span>(<span class="php-var">$query</span>, <span class="php-quote">' ORDER BY '</span>) === <span class="php-keyword1">false</span>) {
</span><span class="l" id="723"> 723                 <span class="php-var">$query</span> .= <span class="php-quote">' ORDER BY `'</span> . <span class="php-var">$sortColumn</span> . <span class="php-quote">'` '</span> . <span class="php-var">$sortType</span>;
</span><span class="l" id="724"> 724             } <span class="php-keyword1">else</span> {
</span><span class="l" id="725"> 725                 <span class="php-var">$query</span> = <span class="php-keyword2">preg_replace</span>(<span class="php-quote">'/ORDER\sBY\s[^ ]*(\sasc|\sdesc)?/i'</span>, <span class="php-quote">'ORDER BY `'</span> . <span class="php-var">$sortColumn</span> . <span class="php-quote">'` '</span> . <span class="php-var">$sortType</span>, <span class="php-var">$query</span>);
</span><span class="l" id="726"> 726             }
</span><span class="l" id="727"> 727         }
</span><span class="l" id="728"> 728 
</span><span class="l" id="729"> 729         <span class="php-keyword1">if</span> (<span class="php-keyword2">stripos</span>(<span class="php-var">$query</span>, <span class="php-quote">' LIMIT '</span>) === <span class="php-keyword1">false</span>) {
</span><span class="l" id="730"> 730             <span class="php-var">$query</span> .= <span class="php-quote">' LIMIT '</span> . <span class="php-var">$startRow</span> . <span class="php-quote">','</span> . <span class="php-var">$rowsPerPage</span>;
</span><span class="l" id="731"> 731         }
</span><span class="l" id="732"> 732 
</span><span class="l" id="733"> 733         <span class="php-keyword1">return</span> <span class="php-var">$query</span>;
</span><span class="l" id="734"> 734     }
</span><span class="l" id="735"> 735 
</span><span class="l" id="736"> 736     <span class="php-comment">/**
</span></span><span class="l" id="737"> 737 <span class="php-comment">     * Gibt die Anzahl der Zeilen zurück, welche vom ursprüngliche SQL Statement betroffen werden.
</span></span><span class="l" id="738"> 738 <span class="php-comment">     *
</span></span><span class="l" id="739"> 739 <span class="php-comment">     * @return int
</span></span><span class="l" id="740"> 740 <span class="php-comment">     */</span>
</span><span class="l" id="741"> 741     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getRows()
</span><span class="l" id="742"> 742     {
</span><span class="l" id="743"> 743         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;rows;
</span><span class="l" id="744"> 744     }
</span><span class="l" id="745"> 745 
</span><span class="l" id="746"> 746     <span class="php-comment">/**
</span></span><span class="l" id="747"> 747 <span class="php-comment">     * Returns the pager for this list.
</span></span><span class="l" id="748"> 748 <span class="php-comment">     *
</span></span><span class="l" id="749"> 749 <span class="php-comment">     * @return rex_pager
</span></span><span class="l" id="750"> 750 <span class="php-comment">     */</span>
</span><span class="l" id="751"> 751     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getPager()
</span><span class="l" id="752"> 752     {
</span><span class="l" id="753"> 753         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;pager;
</span><span class="l" id="754"> 754     }
</span><span class="l" id="755"> 755 
</span><span class="l" id="756"> 756     <span class="php-comment">/**
</span></span><span class="l" id="757"> 757 <span class="php-comment">     * Gibt zurück, nach welcher Spalte sortiert werden soll.
</span></span><span class="l" id="758"> 758 <span class="php-comment">     *
</span></span><span class="l" id="759"> 759 <span class="php-comment">     * @param mixed $default
</span></span><span class="l" id="760"> 760 <span class="php-comment">     *
</span></span><span class="l" id="761"> 761 <span class="php-comment">     * @return string
</span></span><span class="l" id="762"> 762 <span class="php-comment">     */</span>
</span><span class="l" id="763"> 763     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getSortColumn(<span class="php-var">$default</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="764"> 764     {
</span><span class="l" id="765"> 765         <span class="php-keyword1">if</span> (rex_request(<span class="php-quote">'list'</span>, <span class="php-quote">'string'</span>) == <span class="php-var">$this</span>-&gt;getName()) {
</span><span class="l" id="766"> 766             <span class="php-keyword1">return</span> rex_request(<span class="php-quote">'sort'</span>, <span class="php-quote">'string'</span>, <span class="php-var">$default</span>);
</span><span class="l" id="767"> 767         }
</span><span class="l" id="768"> 768         <span class="php-keyword1">return</span> <span class="php-var">$default</span>;
</span><span class="l" id="769"> 769     }
</span><span class="l" id="770"> 770 
</span><span class="l" id="771"> 771     <span class="php-comment">/**
</span></span><span class="l" id="772"> 772 <span class="php-comment">     * Gibt zurück, in welcher Art und Weise sortiert werden soll (ASC/DESC).
</span></span><span class="l" id="773"> 773 <span class="php-comment">     *
</span></span><span class="l" id="774"> 774 <span class="php-comment">     * @param mixed $default
</span></span><span class="l" id="775"> 775 <span class="php-comment">     *
</span></span><span class="l" id="776"> 776 <span class="php-comment">     * @return string
</span></span><span class="l" id="777"> 777 <span class="php-comment">     */</span>
</span><span class="l" id="778"> 778     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getSortType(<span class="php-var">$default</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="779"> 779     {
</span><span class="l" id="780"> 780         <span class="php-keyword1">if</span> (rex_request(<span class="php-quote">'list'</span>, <span class="php-quote">'string'</span>) == <span class="php-var">$this</span>-&gt;getName()) {
</span><span class="l" id="781"> 781             <span class="php-var">$sortType</span> = <span class="php-keyword2">strtolower</span>(rex_request(<span class="php-quote">'sorttype'</span>, <span class="php-quote">'string'</span>));
</span><span class="l" id="782"> 782 
</span><span class="l" id="783"> 783             <span class="php-keyword1">if</span> (<span class="php-keyword2">in_array</span>(<span class="php-var">$sortType</span>, [<span class="php-quote">'asc'</span>, <span class="php-quote">'desc'</span>])) {
</span><span class="l" id="784"> 784                 <span class="php-keyword1">return</span> <span class="php-var">$sortType</span>;
</span><span class="l" id="785"> 785             }
</span><span class="l" id="786"> 786         }
</span><span class="l" id="787"> 787         <span class="php-keyword1">return</span> <span class="php-var">$default</span>;
</span><span class="l" id="788"> 788     }
</span><span class="l" id="789"> 789 
</span><span class="l" id="790"> 790     <span class="php-comment">/**
</span></span><span class="l" id="791"> 791 <span class="php-comment">     * Gibt die Navigation der Liste zurück.
</span></span><span class="l" id="792"> 792 <span class="php-comment">     *
</span></span><span class="l" id="793"> 793 <span class="php-comment">     * @return string
</span></span><span class="l" id="794"> 794 <span class="php-comment">     */</span>
</span><span class="l" id="795"> 795     <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> getPagination()
</span><span class="l" id="796"> 796     {
</span><span class="l" id="797"> 797         <span class="php-var">$fragment</span> = <span class="php-keyword1">new</span> rex_fragment();
</span><span class="l" id="798"> 798         <span class="php-var">$fragment</span>-&gt;setVar(<span class="php-quote">'urlprovider'</span>, <span class="php-var">$this</span>);
</span><span class="l" id="799"> 799         <span class="php-var">$fragment</span>-&gt;setVar(<span class="php-quote">'pager'</span>, <span class="php-var">$this</span>-&gt;pager);
</span><span class="l" id="800"> 800         <span class="php-keyword1">return</span> <span class="php-var">$fragment</span>-&gt;parse(<span class="php-quote">'core/navigations/pagination.php'</span>);
</span><span class="l" id="801"> 801     }
</span><span class="l" id="802"> 802 
</span><span class="l" id="803"> 803     <span class="php-comment">/**
</span></span><span class="l" id="804"> 804 <span class="php-comment">     * Gibt den Footer der Liste zurück.
</span></span><span class="l" id="805"> 805 <span class="php-comment">     *
</span></span><span class="l" id="806"> 806 <span class="php-comment">     * @return string
</span></span><span class="l" id="807"> 807 <span class="php-comment">     */</span>
</span><span class="l" id="808"> 808     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getFooter()
</span><span class="l" id="809"> 809     {
</span><span class="l" id="810"> 810         <span class="php-var">$s</span> = <span class="php-quote">''</span>;
</span><span class="l" id="811"> 811         <span class="php-comment">/*
</span></span><span class="l" id="812"> 812 <span class="php-comment">        $s .= '            &lt;tr&gt;'. "\n";
</span></span><span class="l" id="813"> 813 <span class="php-comment">        $s .= '                &lt;td colspan="'. count($this-&gt;getColumnNames()) .'"&gt;&lt;input type="text" name="items" value="'. $this-&gt;getRowsPerPage() .'" maxlength="2" /&gt;&lt;input type="submit" value="Anzeigen" /&gt;&lt;/td&gt;'. "\n";
</span></span><span class="l" id="814"> 814 <span class="php-comment">        $s .= '            &lt;/tr&gt;'. "\n";
</span></span><span class="l" id="815"> 815 <span class="php-comment">        */</span>
</span><span class="l" id="816"> 816         <span class="php-keyword1">return</span> <span class="php-var">$s</span>;
</span><span class="l" id="817"> 817     }
</span><span class="l" id="818"> 818 
</span><span class="l" id="819"> 819     <span class="php-comment">/**
</span></span><span class="l" id="820"> 820 <span class="php-comment">     * Gibt den Header der Liste zurück.
</span></span><span class="l" id="821"> 821 <span class="php-comment">     *
</span></span><span class="l" id="822"> 822 <span class="php-comment">     * @return string
</span></span><span class="l" id="823"> 823 <span class="php-comment">     */</span>
</span><span class="l" id="824"> 824     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getHeader()
</span><span class="l" id="825"> 825     {
</span><span class="l" id="826"> 826         <span class="php-var">$s</span> = <span class="php-quote">''</span>;
</span><span class="l" id="827"> 827         <span class="php-var">$s</span> .= <span class="php-var">$this</span>-&gt;getPagination();
</span><span class="l" id="828"> 828 
</span><span class="l" id="829"> 829         <span class="php-keyword1">return</span> <span class="php-var">$s</span>;
</span><span class="l" id="830"> 830     }
</span><span class="l" id="831"> 831 
</span><span class="l" id="832"> 832     <span class="php-comment">// ---------------------- Generate Output</span>
</span><span class="l" id="833"> 833 
</span><span class="l" id="834"> 834     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> replaceVariable(<span class="php-var">$string</span>, <span class="php-var">$varname</span>)
</span><span class="l" id="835"> 835     {
</span><span class="l" id="836"> 836         <span class="php-keyword1">return</span> <span class="php-keyword2">str_replace</span>(<span class="php-quote">'###'</span> . <span class="php-var">$varname</span> . <span class="php-quote">'###'</span>, <span class="php-keyword2">htmlspecialchars</span>(<span class="php-var">$this</span>-&gt;getValue(<span class="php-var">$varname</span>)), <span class="php-var">$string</span>);
</span><span class="l" id="837"> 837     }
</span><span class="l" id="838"> 838 
</span><span class="l" id="839"> 839     <span class="php-comment">/**
</span></span><span class="l" id="840"> 840 <span class="php-comment">     * Ersetzt alle Variablen im Format ###&amp;lt;Spaltenname&amp;gt;###.
</span></span><span class="l" id="841"> 841 <span class="php-comment">     *
</span></span><span class="l" id="842"> 842 <span class="php-comment">     * @param string $value Zu durchsuchender String
</span></span><span class="l" id="843"> 843 <span class="php-comment">     *
</span></span><span class="l" id="844"> 844 <span class="php-comment">     * @return string
</span></span><span class="l" id="845"> 845 <span class="php-comment">     */</span>
</span><span class="l" id="846"> 846     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> replaceVariables(<span class="php-var">$value</span>)
</span><span class="l" id="847"> 847     {
</span><span class="l" id="848"> 848         <span class="php-keyword1">if</span> (<span class="php-keyword2">strpos</span>(<span class="php-var">$value</span>, <span class="php-quote">'###'</span>) === <span class="php-keyword1">false</span>) {
</span><span class="l" id="849"> 849             <span class="php-keyword1">return</span> <span class="php-var">$value</span>;
</span><span class="l" id="850"> 850         }
</span><span class="l" id="851"> 851 
</span><span class="l" id="852"> 852         <span class="php-var">$columnNames</span> = <span class="php-var">$this</span>-&gt;getColumnNames();
</span><span class="l" id="853"> 853 
</span><span class="l" id="854"> 854         <span class="php-keyword1">if</span> (<span class="php-keyword2">is_array</span>(<span class="php-var">$columnNames</span>)) {
</span><span class="l" id="855"> 855             <span class="php-keyword1">foreach</span> (<span class="php-var">$columnNames</span> <span class="php-keyword1">as</span> <span class="php-var">$columnName</span>) {
</span><span class="l" id="856"> 856                 <span class="php-comment">// Spalten, die mit addColumn eingefügt wurden</span>
</span><span class="l" id="857"> 857                 <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;customColumns[<span class="php-var">$columnName</span>])) {
</span><span class="l" id="858"> 858                     <span class="php-keyword1">continue</span>;
</span><span class="l" id="859"> 859                 }
</span><span class="l" id="860"> 860 
</span><span class="l" id="861"> 861                 <span class="php-var">$value</span> = <span class="php-var">$this</span>-&gt;replaceVariable(<span class="php-var">$value</span>, <span class="php-var">$columnName</span>);
</span><span class="l" id="862"> 862             }
</span><span class="l" id="863"> 863         }
</span><span class="l" id="864"> 864         <span class="php-keyword1">return</span> <span class="php-var">$value</span>;
</span><span class="l" id="865"> 865     }
</span><span class="l" id="866"> 866 
</span><span class="l" id="867"> 867     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> isCustomFormat(<span class="php-var">$format</span>)
</span><span class="l" id="868"> 868     {
</span><span class="l" id="869"> 869         <span class="php-keyword1">return</span> <span class="php-keyword2">is_array</span>(<span class="php-var">$format</span>) &amp;&amp; <span class="php-keyword1">isset</span>(<span class="php-var">$format</span>[<span class="php-num">0</span>]) &amp;&amp; <span class="php-var">$format</span>[<span class="php-num">0</span>] == <span class="php-quote">'custom'</span>;
</span><span class="l" id="870"> 870     }
</span><span class="l" id="871"> 871 
</span><span class="l" id="872"> 872     <span class="php-comment">/**
</span></span><span class="l" id="873"> 873 <span class="php-comment">     * Formatiert einen übergebenen String anhand der rexFormatter Klasse.
</span></span><span class="l" id="874"> 874 <span class="php-comment">     *
</span></span><span class="l" id="875"> 875 <span class="php-comment">     * @param string $value  Zu formatierender String
</span></span><span class="l" id="876"> 876 <span class="php-comment">     * @param array  $format mit den Formatierungsinformationen
</span></span><span class="l" id="877"> 877 <span class="php-comment">     * @param bool   $escape Flag, Ob escapen von $value erlaubt ist
</span></span><span class="l" id="878"> 878 <span class="php-comment">     * @param string $field
</span></span><span class="l" id="879"> 879 <span class="php-comment">     *
</span></span><span class="l" id="880"> 880 <span class="php-comment">     * @return string
</span></span><span class="l" id="881"> 881 <span class="php-comment">     */</span>
</span><span class="l" id="882"> 882     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> formatValue(<span class="php-var">$value</span>, <span class="php-var">$format</span>, <span class="php-var">$escape</span>, <span class="php-var">$field</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="883"> 883     {
</span><span class="l" id="884"> 884         <span class="php-keyword1">if</span> (<span class="php-keyword2">is_array</span>(<span class="php-var">$format</span>)) {
</span><span class="l" id="885"> 885             <span class="php-comment">// Callbackfunktion -&gt; Parameterliste aufbauen</span>
</span><span class="l" id="886"> 886             <span class="php-keyword1">if</span> (<span class="php-var">$this</span>-&gt;isCustomFormat(<span class="php-var">$format</span>)) {
</span><span class="l" id="887"> 887                 <span class="php-var">$format</span>[<span class="php-num">2</span>] = <span class="php-keyword1">isset</span>(<span class="php-var">$format</span>[<span class="php-num">2</span>]) ? <span class="php-var">$format</span>[<span class="php-num">2</span>] : [];
</span><span class="l" id="888"> 888                 <span class="php-var">$format</span>[<span class="php-num">1</span>] = [<span class="php-var">$format</span>[<span class="php-num">1</span>], [<span class="php-quote">'list'</span> =&gt; <span class="php-var">$this</span>, <span class="php-quote">'field'</span> =&gt; <span class="php-var">$field</span>, <span class="php-quote">'value'</span> =&gt; <span class="php-var">$value</span>, <span class="php-quote">'format'</span> =&gt; <span class="php-var">$format</span>[<span class="php-num">0</span>], <span class="php-quote">'escape'</span> =&gt; <span class="php-var">$escape</span>, <span class="php-quote">'params'</span> =&gt; <span class="php-var">$format</span>[<span class="php-num">2</span>]]];
</span><span class="l" id="889"> 889             }
</span><span class="l" id="890"> 890 
</span><span class="l" id="891"> 891             <span class="php-var">$value</span> = rex_formatter::format(<span class="php-var">$value</span>, <span class="php-var">$format</span>[<span class="php-num">0</span>], <span class="php-var">$format</span>[<span class="php-num">1</span>]);
</span><span class="l" id="892"> 892         }
</span><span class="l" id="893"> 893 
</span><span class="l" id="894"> 894         <span class="php-comment">// Nur escapen, wenn formatter aufgerufen wird, der kein html zurückgeben können soll</span>
</span><span class="l" id="895"> 895         <span class="php-keyword1">if</span> (<span class="php-var">$escape</span> &amp;&amp;
</span><span class="l" id="896"> 896             !<span class="php-var">$this</span>-&gt;isCustomFormat(<span class="php-var">$format</span>) &amp;&amp;
</span><span class="l" id="897"> 897             <span class="php-var">$format</span>[<span class="php-num">0</span>] != <span class="php-quote">'email'</span> &amp;&amp;
</span><span class="l" id="898"> 898             <span class="php-var">$format</span>[<span class="php-num">0</span>] != <span class="php-quote">'url'</span>
</span><span class="l" id="899"> 899         ) {
</span><span class="l" id="900"> 900             <span class="php-var">$value</span> = <span class="php-keyword2">htmlspecialchars</span>(<span class="php-var">$value</span>);
</span><span class="l" id="901"> 901         }
</span><span class="l" id="902"> 902 
</span><span class="l" id="903"> 903         <span class="php-keyword1">return</span> <span class="php-var">$value</span>;
</span><span class="l" id="904"> 904     }
</span><span class="l" id="905"> 905 
</span><span class="l" id="906"> 906     <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> _getAttributeString(<span class="php-var">$array</span>)
</span><span class="l" id="907"> 907     {
</span><span class="l" id="908"> 908         <span class="php-var">$s</span> = <span class="php-quote">''</span>;
</span><span class="l" id="909"> 909 
</span><span class="l" id="910"> 910         <span class="php-keyword1">foreach</span> (<span class="php-var">$array</span> <span class="php-keyword1">as</span> <span class="php-var">$name</span> =&gt; <span class="php-var">$value</span>) {
</span><span class="l" id="911"> 911             <span class="php-var">$s</span> .= <span class="php-quote">' '</span> . <span class="php-keyword2">htmlspecialchars</span>(<span class="php-var">$name</span>) . <span class="php-quote">'="'</span> . <span class="php-keyword2">htmlspecialchars</span>(<span class="php-var">$value</span>) . <span class="php-quote">'"'</span>;
</span><span class="l" id="912"> 912         }
</span><span class="l" id="913"> 913 
</span><span class="l" id="914"> 914         <span class="php-keyword1">return</span> <span class="php-var">$s</span>;
</span><span class="l" id="915"> 915     }
</span><span class="l" id="916"> 916 
</span><span class="l" id="917"> 917     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getColumnLink(<span class="php-var">$columnName</span>, <span class="php-var">$columnValue</span>, <span class="php-var">$params</span> = [])
</span><span class="l" id="918"> 918     {
</span><span class="l" id="919"> 919         <span class="php-keyword1">return</span> <span class="php-quote">'&lt;a href="'</span> . <span class="php-var">$this</span>-&gt;getParsedUrl(<span class="php-keyword2">array_merge</span>(<span class="php-var">$this</span>-&gt;getColumnParams(<span class="php-var">$columnName</span>), <span class="php-var">$params</span>)) . <span class="php-quote">'"'</span> . <span class="php-var">$this</span>-&gt;_getAttributeString(<span class="php-var">$this</span>-&gt;getLinkAttributes(<span class="php-var">$columnName</span>, [])) . <span class="php-quote">'&gt;'</span> . <span class="php-var">$columnValue</span> . <span class="php-quote">'&lt;/a&gt;'</span>;
</span><span class="l" id="920"> 920     }
</span><span class="l" id="921"> 921 
</span><span class="l" id="922"> 922     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getValue(<span class="php-var">$colname</span>)
</span><span class="l" id="923"> 923     {
</span><span class="l" id="924"> 924         <span class="php-keyword1">return</span> <span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;customColumns[<span class="php-var">$colname</span>]) ? <span class="php-var">$this</span>-&gt;customColumns[<span class="php-var">$colname</span>] : <span class="php-var">$this</span>-&gt;sql-&gt;getValue(<span class="php-var">$colname</span>);
</span><span class="l" id="925"> 925     }
</span><span class="l" id="926"> 926 
</span><span class="l" id="927"> 927     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getArrayValue(<span class="php-var">$colname</span>)
</span><span class="l" id="928"> 928     {
</span><span class="l" id="929"> 929         <span class="php-keyword1">return</span> <span class="php-keyword2">json_decode</span>(<span class="php-var">$this</span>-&gt;getValue(<span class="php-var">$colname</span>), <span class="php-keyword1">true</span>);
</span><span class="l" id="930"> 930     }
</span><span class="l" id="931"> 931 
</span><span class="l" id="932"> 932     <span class="php-comment">/**
</span></span><span class="l" id="933"> 933 <span class="php-comment">     * Erstellt den Tabellen Quellcode.
</span></span><span class="l" id="934"> 934 <span class="php-comment">     *
</span></span><span class="l" id="935"> 935 <span class="php-comment">     * @return string
</span></span><span class="l" id="936"> 936 <span class="php-comment">     */</span>
</span><span class="l" id="937"> 937     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> get()
</span><span class="l" id="938"> 938     {
</span><span class="l" id="939"> 939         rex_extension::registerPoint(<span class="php-keyword1">new</span> rex_extension_point(<span class="php-quote">'REX_LIST_GET'</span>, <span class="php-var">$this</span>, [], <span class="php-keyword1">true</span>));
</span><span class="l" id="940"> 940 
</span><span class="l" id="941"> 941         <span class="php-var">$s</span> = <span class="php-quote">"\n"</span>;
</span><span class="l" id="942"> 942 
</span><span class="l" id="943"> 943         <span class="php-comment">// Form vars</span>
</span><span class="l" id="944"> 944         <span class="php-var">$this</span>-&gt;addFormAttribute(<span class="php-quote">'action'</span>, <span class="php-var">$this</span>-&gt;getUrl([], <span class="php-keyword1">false</span>));
</span><span class="l" id="945"> 945         <span class="php-var">$this</span>-&gt;addFormAttribute(<span class="php-quote">'method'</span>, <span class="php-quote">'post'</span>);
</span><span class="l" id="946"> 946 
</span><span class="l" id="947"> 947         <span class="php-comment">// Table vars</span>
</span><span class="l" id="948"> 948         <span class="php-var">$caption</span> = <span class="php-var">$this</span>-&gt;getCaption();
</span><span class="l" id="949"> 949         <span class="php-var">$tableColumnGroups</span> = <span class="php-var">$this</span>-&gt;getTableColumnGroups();
</span><span class="l" id="950"> 950         <span class="php-var">$class</span> = <span class="php-quote">'table'</span>;
</span><span class="l" id="951"> 951         <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;tableAttributes[<span class="php-quote">'class'</span>])) {
</span><span class="l" id="952"> 952             <span class="php-var">$class</span> .= <span class="php-quote">' '</span> . <span class="php-var">$this</span>-&gt;tableAttributes[<span class="php-quote">'class'</span>];
</span><span class="l" id="953"> 953         }
</span><span class="l" id="954"> 954         <span class="php-var">$this</span>-&gt;addTableAttribute(<span class="php-quote">'class'</span>, <span class="php-var">$class</span>);
</span><span class="l" id="955"> 955 
</span><span class="l" id="956"> 956         <span class="php-comment">// Columns vars</span>
</span><span class="l" id="957"> 957         <span class="php-var">$columnFormates</span> = [];
</span><span class="l" id="958"> 958         <span class="php-var">$columnNames</span> = [];
</span><span class="l" id="959"> 959         <span class="php-keyword1">foreach</span> (<span class="php-var">$this</span>-&gt;getColumnNames() <span class="php-keyword1">as</span> <span class="php-var">$columnName</span>) {
</span><span class="l" id="960"> 960             <span class="php-keyword1">if</span> (!<span class="php-keyword2">in_array</span>(<span class="php-var">$columnName</span>, <span class="php-var">$this</span>-&gt;columnDisabled)) {
</span><span class="l" id="961"> 961                 <span class="php-var">$columnNames</span>[] = <span class="php-var">$columnName</span>;
</span><span class="l" id="962"> 962             }
</span><span class="l" id="963"> 963         }
</span><span class="l" id="964"> 964 
</span><span class="l" id="965"> 965         <span class="php-comment">// List vars</span>
</span><span class="l" id="966"> 966         <span class="php-var">$sortColumn</span> = <span class="php-var">$this</span>-&gt;getSortColumn();
</span><span class="l" id="967"> 967         <span class="php-var">$sortType</span> = <span class="php-var">$this</span>-&gt;getSortType();
</span><span class="l" id="968"> 968         <span class="php-var">$warning</span> = <span class="php-var">$this</span>-&gt;getWarning();
</span><span class="l" id="969"> 969         <span class="php-var">$message</span> = <span class="php-var">$this</span>-&gt;getMessage();
</span><span class="l" id="970"> 970         <span class="php-var">$nbRows</span> = <span class="php-var">$this</span>-&gt;getRows();
</span><span class="l" id="971"> 971 
</span><span class="l" id="972"> 972         <span class="php-var">$header</span> = <span class="php-var">$this</span>-&gt;getHeader();
</span><span class="l" id="973"> 973         <span class="php-var">$footer</span> = <span class="php-var">$this</span>-&gt;getFooter();
</span><span class="l" id="974"> 974 
</span><span class="l" id="975"> 975         <span class="php-keyword1">if</span> (<span class="php-var">$warning</span> != <span class="php-quote">''</span>) {
</span><span class="l" id="976"> 976             <span class="php-var">$s</span> .= rex_view::warning(<span class="php-var">$warning</span>) . <span class="php-quote">"\n"</span>;
</span><span class="l" id="977"> 977         } <span class="php-keyword1">elseif</span> (<span class="php-var">$message</span> != <span class="php-quote">''</span>) {
</span><span class="l" id="978"> 978             <span class="php-var">$s</span> .= rex_view::info(<span class="php-var">$message</span>) . <span class="php-quote">"\n"</span>;
</span><span class="l" id="979"> 979         }
</span><span class="l" id="980"> 980 
</span><span class="l" id="981"> 981         <span class="php-keyword1">if</span> (<span class="php-var">$header</span> != <span class="php-quote">''</span>) {
</span><span class="l" id="982"> 982             <span class="php-var">$s</span> .= <span class="php-var">$header</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="983"> 983         }
</span><span class="l" id="984"> 984 
</span><span class="l" id="985"> 985         <span class="php-var">$s</span> .= <span class="php-quote">'&lt;form'</span> . <span class="php-var">$this</span>-&gt;_getAttributeString(<span class="php-var">$this</span>-&gt;getFormAttributes()) . <span class="php-quote">'&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="986"> 986         <span class="php-var">$s</span> .= <span class="php-quote">'    &lt;table'</span> . <span class="php-var">$this</span>-&gt;_getAttributeString(<span class="php-var">$this</span>-&gt;getTableAttributes()) . <span class="php-quote">'&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="987"> 987 
</span><span class="l" id="988"> 988         <span class="php-keyword1">if</span> (<span class="php-var">$caption</span> != <span class="php-quote">''</span>) {
</span><span class="l" id="989"> 989             <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;caption&gt;'</span> . <span class="php-keyword2">htmlspecialchars</span>(<span class="php-var">$caption</span>) . <span class="php-quote">'&lt;/caption&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="990"> 990         }
</span><span class="l" id="991"> 991 
</span><span class="l" id="992"> 992         <span class="php-keyword1">if</span> (<span class="php-keyword2">count</span>(<span class="php-var">$tableColumnGroups</span>) &gt; <span class="php-num">0</span>) {
</span><span class="l" id="993"> 993             <span class="php-keyword1">foreach</span> (<span class="php-var">$tableColumnGroups</span> <span class="php-keyword1">as</span> <span class="php-var">$tableColumnGroup</span>) {
</span><span class="l" id="994"> 994                 <span class="php-var">$tableColumns</span> = <span class="php-var">$tableColumnGroup</span>[<span class="php-quote">'columns'</span>];
</span><span class="l" id="995"> 995                 <span class="php-keyword1">unset</span>(<span class="php-var">$tableColumnGroup</span>[<span class="php-quote">'columns'</span>]);
</span><span class="l" id="996"> 996 
</span><span class="l" id="997"> 997                 <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;colgroup'</span> . <span class="php-var">$this</span>-&gt;_getAttributeString(<span class="php-var">$tableColumnGroup</span>) . <span class="php-quote">'&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="998"> 998 
</span><span class="l" id="999"> 999                 <span class="php-keyword1">foreach</span> (<span class="php-var">$tableColumns</span> <span class="php-keyword1">as</span> <span class="php-var">$tableColumn</span>) {
</span><span class="l" id="1000">1000                     <span class="php-var">$s</span> .= <span class="php-quote">'            &lt;col'</span> . <span class="php-var">$this</span>-&gt;_getAttributeString(<span class="php-var">$tableColumn</span>) . <span class="php-quote">' /&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1001">1001                 }
</span><span class="l" id="1002">1002 
</span><span class="l" id="1003">1003                 <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;/colgroup&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1004">1004             }
</span><span class="l" id="1005">1005         }
</span><span class="l" id="1006">1006 
</span><span class="l" id="1007">1007         <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;thead&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1008">1008         <span class="php-var">$s</span> .= <span class="php-quote">'            &lt;tr&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1009">1009         <span class="php-keyword1">foreach</span> (<span class="php-var">$columnNames</span> <span class="php-keyword1">as</span> <span class="php-var">$columnName</span>) {
</span><span class="l" id="1010">1010             <span class="php-var">$columnHead</span> = <span class="php-var">$this</span>-&gt;getColumnLabel(<span class="php-var">$columnName</span>);
</span><span class="l" id="1011">1011             <span class="php-keyword1">if</span> (<span class="php-var">$this</span>-&gt;hasColumnOption(<span class="php-var">$columnName</span>, REX_LIST_OPT_SORT)) {
</span><span class="l" id="1012">1012                 <span class="php-keyword1">if</span> (<span class="php-var">$columnName</span> == <span class="php-var">$sortColumn</span>) {
</span><span class="l" id="1013">1013                     <span class="php-var">$columnSortType</span> = <span class="php-var">$sortType</span> == <span class="php-quote">'desc'</span> ? <span class="php-quote">'asc'</span> : <span class="php-quote">'desc'</span>;
</span><span class="l" id="1014">1014                 } <span class="php-keyword1">else</span> {
</span><span class="l" id="1015">1015                     <span class="php-var">$columnSortType</span> = <span class="php-var">$this</span>-&gt;getColumnOption(<span class="php-var">$columnName</span>, REX_LIST_OPT_SORT_DIRECTION, <span class="php-quote">'asc'</span>);
</span><span class="l" id="1016">1016                 }
</span><span class="l" id="1017">1017                 <span class="php-var">$columnHead</span> = <span class="php-quote">'&lt;a href="'</span> . <span class="php-var">$this</span>-&gt;getUrl([<span class="php-quote">'start'</span> =&gt; <span class="php-var">$this</span>-&gt;pager-&gt;getCursor(), <span class="php-quote">'sort'</span> =&gt; <span class="php-var">$columnName</span>, <span class="php-quote">'sorttype'</span> =&gt; <span class="php-var">$columnSortType</span>]) . <span class="php-quote">'"&gt;'</span> . <span class="php-var">$columnHead</span> . <span class="php-quote">'&lt;/a&gt;'</span>;
</span><span class="l" id="1018">1018             }
</span><span class="l" id="1019">1019 
</span><span class="l" id="1020">1020             <span class="php-var">$layout</span> = <span class="php-var">$this</span>-&gt;getColumnLayout(<span class="php-var">$columnName</span>);
</span><span class="l" id="1021">1021             <span class="php-var">$s</span> .= <span class="php-quote">'        '</span> . <span class="php-keyword2">str_replace</span>(<span class="php-quote">'###VALUE###'</span>, <span class="php-var">$columnHead</span>, <span class="php-var">$layout</span>[<span class="php-num">0</span>]) . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1022">1022 
</span><span class="l" id="1023">1023             <span class="php-comment">// Formatierungen hier holen, da diese Schleife jede Spalte nur einmal durchläuft</span>
</span><span class="l" id="1024">1024             <span class="php-var">$columnFormates</span>[<span class="php-var">$columnName</span>] = <span class="php-var">$this</span>-&gt;getColumnFormat(<span class="php-var">$columnName</span>);
</span><span class="l" id="1025">1025         }
</span><span class="l" id="1026">1026         <span class="php-var">$s</span> .= <span class="php-quote">'            &lt;/tr&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1027">1027         <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;/thead&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1028">1028 
</span><span class="l" id="1029">1029         <span class="php-keyword1">if</span> (<span class="php-var">$footer</span> != <span class="php-quote">''</span>) {
</span><span class="l" id="1030">1030             <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;tfoot&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1031">1031             <span class="php-var">$s</span> .= <span class="php-var">$footer</span>;
</span><span class="l" id="1032">1032             <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;/tfoot&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1033">1033         }
</span><span class="l" id="1034">1034 
</span><span class="l" id="1035">1035         <span class="php-keyword1">if</span> (<span class="php-var">$nbRows</span> &gt; <span class="php-num">0</span>) {
</span><span class="l" id="1036">1036             <span class="php-var">$maxRows</span> = <span class="php-var">$nbRows</span> - <span class="php-var">$this</span>-&gt;pager-&gt;getCursor();
</span><span class="l" id="1037">1037 
</span><span class="l" id="1038">1038             <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;tbody&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1039">1039             <span class="php-keyword1">for</span> (<span class="php-var">$i</span> = <span class="php-num">0</span>; <span class="php-var">$i</span> &lt; <span class="php-var">$this</span>-&gt;pager-&gt;getRowsPerPage() &amp;&amp; <span class="php-var">$i</span> &lt; <span class="php-var">$maxRows</span>; ++<span class="php-var">$i</span>) {
</span><span class="l" id="1040">1040                 <span class="php-var">$s</span> .= <span class="php-quote">'            &lt;tr&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1041">1041                 <span class="php-keyword1">foreach</span> (<span class="php-var">$columnNames</span> <span class="php-keyword1">as</span> <span class="php-var">$columnName</span>) {
</span><span class="l" id="1042">1042                     <span class="php-var">$columnValue</span> = <span class="php-var">$this</span>-&gt;formatValue(<span class="php-var">$this</span>-&gt;getValue(<span class="php-var">$columnName</span>), <span class="php-var">$columnFormates</span>[<span class="php-var">$columnName</span>], !<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;customColumns[<span class="php-var">$columnName</span>]), <span class="php-var">$columnName</span>);
</span><span class="l" id="1043">1043 
</span><span class="l" id="1044">1044                     <span class="php-keyword1">if</span> (!<span class="php-var">$this</span>-&gt;isCustomFormat(<span class="php-var">$columnFormates</span>[<span class="php-var">$columnName</span>]) &amp;&amp; <span class="php-var">$this</span>-&gt;hasColumnParams(<span class="php-var">$columnName</span>)) {
</span><span class="l" id="1045">1045                         <span class="php-var">$columnValue</span> = <span class="php-var">$this</span>-&gt;getColumnLink(<span class="php-var">$columnName</span>, <span class="php-var">$columnValue</span>);
</span><span class="l" id="1046">1046                     }
</span><span class="l" id="1047">1047 
</span><span class="l" id="1048">1048                     <span class="php-var">$columnHead</span> = <span class="php-var">$this</span>-&gt;getColumnLabel(<span class="php-var">$columnName</span>);
</span><span class="l" id="1049">1049                     <span class="php-var">$layout</span> = <span class="php-var">$this</span>-&gt;getColumnLayout(<span class="php-var">$columnName</span>);
</span><span class="l" id="1050">1050                     <span class="php-var">$columnValue</span> = <span class="php-keyword2">str_replace</span>([<span class="php-quote">'###VALUE###'</span>, <span class="php-quote">'###LABEL###'</span>], [<span class="php-var">$columnValue</span>, <span class="php-var">$columnHead</span>], <span class="php-var">$layout</span>[<span class="php-num">1</span>]);
</span><span class="l" id="1051">1051                     <span class="php-var">$columnValue</span> = <span class="php-var">$this</span>-&gt;replaceVariables(<span class="php-var">$columnValue</span>);
</span><span class="l" id="1052">1052                     <span class="php-var">$s</span> .= <span class="php-quote">'        '</span> . <span class="php-var">$columnValue</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1053">1053                 }
</span><span class="l" id="1054">1054                 <span class="php-var">$s</span> .= <span class="php-quote">'            &lt;/tr&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1055">1055 
</span><span class="l" id="1056">1056                 <span class="php-var">$this</span>-&gt;sql-&gt;<span class="php-keyword2">next</span>();
</span><span class="l" id="1057">1057             }
</span><span class="l" id="1058">1058             <span class="php-var">$s</span> .= <span class="php-quote">'        &lt;/tbody&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1059">1059         } <span class="php-keyword1">else</span> {
</span><span class="l" id="1060">1060             <span class="php-var">$s</span> .= <span class="php-quote">'&lt;tr class="table-no-results"&gt;&lt;td colspan="'</span> . <span class="php-keyword2">count</span>(<span class="php-var">$columnNames</span>) . <span class="php-quote">'"&gt;'</span> . <span class="php-var">$this</span>-&gt;getNoRowsMessage() . <span class="php-quote">'&lt;/td&gt;&lt;/tr&gt;'</span>;
</span><span class="l" id="1061">1061         }
</span><span class="l" id="1062">1062 
</span><span class="l" id="1063">1063         <span class="php-var">$s</span> .= <span class="php-quote">'    &lt;/table&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1064">1064         <span class="php-var">$s</span> .= <span class="php-quote">'&lt;/form&gt;'</span> . <span class="php-quote">"\n"</span>;
</span><span class="l" id="1065">1065 
</span><span class="l" id="1066">1066         <span class="php-keyword1">return</span> <span class="php-var">$s</span>;
</span><span class="l" id="1067">1067     }
</span><span class="l" id="1068">1068 
</span><span class="l" id="1069">1069     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> show()
</span><span class="l" id="1070">1070     {
</span><span class="l" id="1071">1071         <span class="php-keyword1">echo</span> <span class="php-var">$this</span>-&gt;get();
</span><span class="l" id="1072">1072     }
</span><span class="l" id="1073">1073 }
</span><span class="l" id="1074">1074 </span></code></pre>
 </body>
</html>
