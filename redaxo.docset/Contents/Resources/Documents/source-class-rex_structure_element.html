<!DOCTYPE html>
<html lang="de">
 <head>
  <meta charset="utf-8"/>
  <link href="../Assets/css/styles.css" rel="stylesheet"/>
  <script src="../Assets/js/script.js">
  </script>
 </head>
 <body>
  <pre id="source"><code><span class="l" id="1">  1 <span class="xlang">&lt;?php</span>
</span><span class="l" id="2">  2 
</span><span class="l" id="3">  3 <span class="php-comment">/**
</span></span><span class="l" id="4">  4 <span class="php-comment"> * Object Oriented Framework: Basisklasse f√ºr die Strukturkomponenten.
</span></span><span class="l" id="5">  5 <span class="php-comment"> *
</span></span><span class="l" id="6">  6 <span class="php-comment"> * @package redaxo\structure
</span></span><span class="l" id="7">  7 <span class="php-comment"> */</span>
</span><span class="l" id="8">  8 <span class="php-keyword1">abstract</span> <span class="php-keyword1">class</span> rex_structure_element
</span><span class="l" id="9">  9 {
</span><span class="l" id="10"> 10     <span class="php-keyword1">use</span> rex_instance_pool_trait;
</span><span class="l" id="11"> 11     <span class="php-keyword1">use</span> rex_instance_list_pool_trait;
</span><span class="l" id="12"> 12 
</span><span class="l" id="13"> 13     <span class="php-comment">/*
</span></span><span class="l" id="14"> 14 <span class="php-comment">     * these vars get read out
</span></span><span class="l" id="15"> 15 <span class="php-comment">     */</span>
</span><span class="l" id="16"> 16     <span class="php-keyword1">protected</span> <span class="php-var">$id</span> = <span class="php-quote">''</span>;
</span><span class="l" id="17"> 17     <span class="php-keyword1">protected</span> <span class="php-var">$parent_id</span> = <span class="php-quote">''</span>;
</span><span class="l" id="18"> 18     <span class="php-keyword1">protected</span> <span class="php-var">$clang_id</span> = <span class="php-quote">''</span>;
</span><span class="l" id="19"> 19     <span class="php-keyword1">protected</span> <span class="php-var">$name</span> = <span class="php-quote">''</span>;
</span><span class="l" id="20"> 20     <span class="php-keyword1">protected</span> <span class="php-var">$catname</span> = <span class="php-quote">''</span>;
</span><span class="l" id="21"> 21     <span class="php-keyword1">protected</span> <span class="php-var">$template_id</span> = <span class="php-quote">''</span>;
</span><span class="l" id="22"> 22     <span class="php-keyword1">protected</span> <span class="php-var">$path</span> = <span class="php-quote">''</span>;
</span><span class="l" id="23"> 23     <span class="php-keyword1">protected</span> <span class="php-var">$priority</span> = <span class="php-quote">''</span>;
</span><span class="l" id="24"> 24     <span class="php-keyword1">protected</span> <span class="php-var">$catpriority</span> = <span class="php-quote">''</span>;
</span><span class="l" id="25"> 25     <span class="php-keyword1">protected</span> <span class="php-var">$startarticle</span> = <span class="php-quote">''</span>;
</span><span class="l" id="26"> 26     <span class="php-keyword1">protected</span> <span class="php-var">$status</span> = <span class="php-quote">''</span>;
</span><span class="l" id="27"> 27     <span class="php-keyword1">protected</span> <span class="php-var">$updatedate</span> = <span class="php-quote">''</span>;
</span><span class="l" id="28"> 28     <span class="php-keyword1">protected</span> <span class="php-var">$createdate</span> = <span class="php-quote">''</span>;
</span><span class="l" id="29"> 29     <span class="php-keyword1">protected</span> <span class="php-var">$updateuser</span> = <span class="php-quote">''</span>;
</span><span class="l" id="30"> 30     <span class="php-keyword1">protected</span> <span class="php-var">$createuser</span> = <span class="php-quote">''</span>;
</span><span class="l" id="31"> 31 
</span><span class="l" id="32"> 32     <span class="php-keyword1">protected</span> <span class="php-keyword1">static</span> <span class="php-var">$classVars</span>;
</span><span class="l" id="33"> 33 
</span><span class="l" id="34"> 34     <span class="php-comment">/**
</span></span><span class="l" id="35"> 35 <span class="php-comment">     * Constructor.
</span></span><span class="l" id="36"> 36 <span class="php-comment">     *
</span></span><span class="l" id="37"> 37 <span class="php-comment">     * @param array $params
</span></span><span class="l" id="38"> 38 <span class="php-comment">     */</span>
</span><span class="l" id="39"> 39     <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> __construct(<span class="php-keyword1">array</span> <span class="php-var">$params</span>)
</span><span class="l" id="40"> 40     {
</span><span class="l" id="41"> 41         <span class="php-keyword1">foreach</span> (self::getClassVars() <span class="php-keyword1">as</span> <span class="php-var">$var</span>) {
</span><span class="l" id="42"> 42             <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$params</span>[<span class="php-var">$var</span>])) {
</span><span class="l" id="43"> 43                 <span class="php-var">$this</span>-&gt;<span class="php-var">$var</span> = <span class="php-var">$params</span>[<span class="php-var">$var</span>];
</span><span class="l" id="44"> 44             }
</span><span class="l" id="45"> 45         }
</span><span class="l" id="46"> 46     }
</span><span class="l" id="47"> 47 
</span><span class="l" id="48"> 48     <span class="php-comment">/**
</span></span><span class="l" id="49"> 49 <span class="php-comment">     * Returns Object Value.
</span></span><span class="l" id="50"> 50 <span class="php-comment">     *
</span></span><span class="l" id="51"> 51 <span class="php-comment">     * @param string $value
</span></span><span class="l" id="52"> 52 <span class="php-comment">     *
</span></span><span class="l" id="53"> 53 <span class="php-comment">     * @return string
</span></span><span class="l" id="54"> 54 <span class="php-comment">     */</span>
</span><span class="l" id="55"> 55     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getValue(<span class="php-var">$value</span>)
</span><span class="l" id="56"> 56     {
</span><span class="l" id="57"> 57         <span class="php-comment">// damit alte rex_article felder wie teaser, online_from etc</span>
</span><span class="l" id="58"> 58         <span class="php-comment">// noch funktionieren</span>
</span><span class="l" id="59"> 59         <span class="php-comment">// gleicher BC code nochmals in article::getValue</span>
</span><span class="l" id="60"> 60         <span class="php-keyword1">foreach</span> ([<span class="php-quote">''</span>, <span class="php-quote">'art_'</span>, <span class="php-quote">'cat_'</span>] <span class="php-keyword1">as</span> <span class="php-var">$prefix</span>) {
</span><span class="l" id="61"> 61             <span class="php-var">$val</span> = <span class="php-var">$prefix</span> . <span class="php-var">$value</span>;
</span><span class="l" id="62"> 62             <span class="php-keyword1">if</span> (<span class="php-keyword1">isset</span>(<span class="php-var">$this</span>-&gt;<span class="php-var">$val</span>)) {
</span><span class="l" id="63"> 63                 <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;<span class="php-var">$val</span>;
</span><span class="l" id="64"> 64             }
</span><span class="l" id="65"> 65         }
</span><span class="l" id="66"> 66         <span class="php-keyword1">return</span> <span class="php-keyword1">null</span>;
</span><span class="l" id="67"> 67     }
</span><span class="l" id="68"> 68 
</span><span class="l" id="69"> 69     <span class="php-comment">/**
</span></span><span class="l" id="70"> 70 <span class="php-comment">     * @param string $value
</span></span><span class="l" id="71"> 71 <span class="php-comment">     * @param array  $prefixes
</span></span><span class="l" id="72"> 72 <span class="php-comment">     *
</span></span><span class="l" id="73"> 73 <span class="php-comment">     * @return bool
</span></span><span class="l" id="74"> 74 <span class="php-comment">     */</span>
</span><span class="l" id="75"> 75     <span class="php-keyword1">protected</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> _hasValue(<span class="php-var">$value</span>, <span class="php-keyword1">array</span> <span class="php-var">$prefixes</span> = [])
</span><span class="l" id="76"> 76     {
</span><span class="l" id="77"> 77         <span class="php-var">$values</span> = self::getClassVars();
</span><span class="l" id="78"> 78 
</span><span class="l" id="79"> 79         <span class="php-keyword1">if</span> (<span class="php-keyword2">in_array</span>(<span class="php-var">$value</span>, <span class="php-var">$values</span>)) {
</span><span class="l" id="80"> 80             <span class="php-keyword1">return</span> <span class="php-keyword1">true</span>;
</span><span class="l" id="81"> 81         }
</span><span class="l" id="82"> 82 
</span><span class="l" id="83"> 83         <span class="php-keyword1">foreach</span> (<span class="php-var">$prefixes</span> <span class="php-keyword1">as</span> <span class="php-var">$prefix</span>) {
</span><span class="l" id="84"> 84             <span class="php-keyword1">if</span> (<span class="php-keyword2">in_array</span>(<span class="php-var">$prefix</span> . <span class="php-var">$value</span>, <span class="php-var">$values</span>)) {
</span><span class="l" id="85"> 85                 <span class="php-keyword1">return</span> <span class="php-keyword1">true</span>;
</span><span class="l" id="86"> 86             }
</span><span class="l" id="87"> 87         }
</span><span class="l" id="88"> 88 
</span><span class="l" id="89"> 89         <span class="php-keyword1">return</span> <span class="php-keyword1">false</span>;
</span><span class="l" id="90"> 90     }
</span><span class="l" id="91"> 91 
</span><span class="l" id="92"> 92     <span class="php-comment">/**
</span></span><span class="l" id="93"> 93 <span class="php-comment">     * Returns an Array containing article field names.
</span></span><span class="l" id="94"> 94 <span class="php-comment">     *
</span></span><span class="l" id="95"> 95 <span class="php-comment">     * @return string[]
</span></span><span class="l" id="96"> 96 <span class="php-comment">     */</span>
</span><span class="l" id="97"> 97     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> getClassVars()
</span><span class="l" id="98"> 98     {
</span><span class="l" id="99"> 99         <span class="php-keyword1">if</span> (<span class="php-keyword1">empty</span>(self::<span class="php-var">$classVars</span>)) {
</span><span class="l" id="100">100             self::<span class="php-var">$classVars</span> = [];
</span><span class="l" id="101">101 
</span><span class="l" id="102">102             <span class="php-var">$startId</span> = rex_article::getSiteStartArticleId();
</span><span class="l" id="103">103             <span class="php-var">$file</span> = rex_path::addonCache(<span class="php-quote">'structure'</span>, <span class="php-var">$startId</span> . <span class="php-quote">'.1.article'</span>);
</span><span class="l" id="104">104             <span class="php-keyword1">if</span> (!rex::isBackend() &amp;&amp; <span class="php-keyword2">file_exists</span>(<span class="php-var">$file</span>)) {
</span><span class="l" id="105">105                 <span class="php-comment">// da getClassVars() eine statische Methode ist, k√∂nnen wir hier nicht mit $this-&gt;getId() arbeiten!</span>
</span><span class="l" id="106">106                 <span class="php-var">$genVars</span> = rex_file::getCache(<span class="php-var">$file</span>);
</span><span class="l" id="107">107                 <span class="php-keyword1">unset</span>(<span class="php-var">$genVars</span>[<span class="php-quote">'last_update_stamp'</span>]);
</span><span class="l" id="108">108                 <span class="php-keyword1">foreach</span> (<span class="php-var">$genVars</span> <span class="php-keyword1">as</span> <span class="php-var">$name</span> =&gt; <span class="php-var">$value</span>) {
</span><span class="l" id="109">109                     self::<span class="php-var">$classVars</span>[] = <span class="php-var">$name</span>;
</span><span class="l" id="110">110                 }
</span><span class="l" id="111">111             } <span class="php-keyword1">else</span> {
</span><span class="l" id="112">112                 <span class="php-comment">// Im Backend die Spalten aus der DB auslesen / via EP holen</span>
</span><span class="l" id="113">113                 <span class="php-var">$sql</span> = rex_sql::factory();
</span><span class="l" id="114">114                 <span class="php-var">$sql</span>-&gt;setQuery(<span class="php-quote">'SELECT * FROM '</span> . rex::getTablePrefix() . <span class="php-quote">'article LIMIT 0'</span>);
</span><span class="l" id="115">115                 <span class="php-keyword1">foreach</span> (<span class="php-var">$sql</span>-&gt;getFieldnames() <span class="php-keyword1">as</span> <span class="php-var">$field</span>) {
</span><span class="l" id="116">116                     self::<span class="php-var">$classVars</span>[] = <span class="php-var">$field</span>;
</span><span class="l" id="117">117                 }
</span><span class="l" id="118">118             }
</span><span class="l" id="119">119         }
</span><span class="l" id="120">120 
</span><span class="l" id="121">121         <span class="php-keyword1">return</span> self::<span class="php-var">$classVars</span>;
</span><span class="l" id="122">122     }
</span><span class="l" id="123">123 
</span><span class="l" id="124">124     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> resetClassVars()
</span><span class="l" id="125">125     {
</span><span class="l" id="126">126         self::<span class="php-var">$classVars</span> = <span class="php-keyword1">null</span>;
</span><span class="l" id="127">127     }
</span><span class="l" id="128">128 
</span><span class="l" id="129">129     <span class="php-comment">/**
</span></span><span class="l" id="130">130 <span class="php-comment">     * Return an rex_structure_element object based on an id.
</span></span><span class="l" id="131">131 <span class="php-comment">     * The instance will be cached in an instance-pool and therefore re-used by a later call.
</span></span><span class="l" id="132">132 <span class="php-comment">     *
</span></span><span class="l" id="133">133 <span class="php-comment">     * @param int $id    the article id
</span></span><span class="l" id="134">134 <span class="php-comment">     * @param int $clang the clang id
</span></span><span class="l" id="135">135 <span class="php-comment">     *
</span></span><span class="l" id="136">136 <span class="php-comment">     * @return static A rex_structure_element instance typed to the late-static binding type of the caller
</span></span><span class="l" id="137">137 <span class="php-comment">     */</span>
</span><span class="l" id="138">138     <span class="php-keyword1">public</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> get(<span class="php-var">$id</span>, <span class="php-var">$clang</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="139">139     {
</span><span class="l" id="140">140         <span class="php-var">$id</span> = (int) <span class="php-var">$id</span>;
</span><span class="l" id="141">141 
</span><span class="l" id="142">142         <span class="php-keyword1">if</span> (<span class="php-var">$id</span> &lt;= <span class="php-num">0</span>) {
</span><span class="l" id="143">143             <span class="php-keyword1">return</span> <span class="php-keyword1">null</span>;
</span><span class="l" id="144">144         }
</span><span class="l" id="145">145 
</span><span class="l" id="146">146         <span class="php-keyword1">if</span> (!<span class="php-var">$clang</span>) {
</span><span class="l" id="147">147             <span class="php-var">$clang</span> = rex_clang::getCurrentId();
</span><span class="l" id="148">148         }
</span><span class="l" id="149">149 
</span><span class="l" id="150">150         <span class="php-var">$class</span> = <span class="php-keyword2">get_called_class</span>();
</span><span class="l" id="151">151         <span class="php-keyword1">return</span> <span class="php-keyword1">static</span>::getInstance([<span class="php-var">$id</span>, <span class="php-var">$clang</span>], <span class="php-keyword1">function</span> (<span class="php-var">$id</span>, <span class="php-var">$clang</span>) <span class="php-keyword1">use</span> (<span class="php-var">$class</span>) {
</span><span class="l" id="152">152             <span class="php-var">$article_path</span> = rex_path::addonCache(<span class="php-quote">'structure'</span>, <span class="php-var">$id</span> . <span class="php-quote">'.'</span> . <span class="php-var">$clang</span> . <span class="php-quote">'.article'</span>);
</span><span class="l" id="153">153             <span class="php-comment">// generate cache if not exists</span>
</span><span class="l" id="154">154             <span class="php-keyword1">if</span> (!<span class="php-keyword2">file_exists</span>(<span class="php-var">$article_path</span>)) {
</span><span class="l" id="155">155                 rex_article_cache::generateMeta(<span class="php-var">$id</span>, <span class="php-var">$clang</span>);
</span><span class="l" id="156">156             }
</span><span class="l" id="157">157 
</span><span class="l" id="158">158             <span class="php-comment">// article is valid, if cache exists after generation</span>
</span><span class="l" id="159">159             <span class="php-keyword1">if</span> (<span class="php-keyword2">file_exists</span>(<span class="php-var">$article_path</span>)) {
</span><span class="l" id="160">160                 <span class="php-comment">// load metadata from cache</span>
</span><span class="l" id="161">161                 <span class="php-var">$metadata</span> = rex_file::getCache(<span class="php-var">$article_path</span>);
</span><span class="l" id="162">162                 <span class="php-comment">// create object with the loaded metadata</span>
</span><span class="l" id="163">163                 <span class="php-keyword1">return</span> <span class="php-keyword1">new</span> <span class="php-var">$class</span>(<span class="php-var">$metadata</span>);
</span><span class="l" id="164">164             }
</span><span class="l" id="165">165 
</span><span class="l" id="166">166             <span class="php-keyword1">return</span> <span class="php-keyword1">null</span>;
</span><span class="l" id="167">167         });
</span><span class="l" id="168">168     }
</span><span class="l" id="169">169 
</span><span class="l" id="170">170     <span class="php-comment">/**
</span></span><span class="l" id="171">171 <span class="php-comment">     * @param int    $parentId
</span></span><span class="l" id="172">172 <span class="php-comment">     * @param string $listType
</span></span><span class="l" id="173">173 <span class="php-comment">     * @param bool   $ignoreOfflines
</span></span><span class="l" id="174">174 <span class="php-comment">     * @param int    $clang
</span></span><span class="l" id="175">175 <span class="php-comment">     *
</span></span><span class="l" id="176">176 <span class="php-comment">     * @return static[]
</span></span><span class="l" id="177">177 <span class="php-comment">     */</span>
</span><span class="l" id="178">178     <span class="php-keyword1">protected</span> <span class="php-keyword1">static</span> <span class="php-keyword1">function</span> getChildElements(<span class="php-var">$parentId</span>, <span class="php-var">$listType</span>, <span class="php-var">$ignoreOfflines</span> = <span class="php-keyword1">false</span>, <span class="php-var">$clang</span> = <span class="php-keyword1">null</span>)
</span><span class="l" id="179">179     {
</span><span class="l" id="180">180         <span class="php-var">$parentId</span> = (int) <span class="php-var">$parentId</span>;
</span><span class="l" id="181">181         <span class="php-comment">// for $parentId=0 root elements will be returned, so abort here for $parentId&lt;0 only</span>
</span><span class="l" id="182">182         <span class="php-keyword1">if</span> (<span class="php-num">0</span> &gt; <span class="php-var">$parentId</span>) {
</span><span class="l" id="183">183             <span class="php-keyword1">return</span> [];
</span><span class="l" id="184">184         }
</span><span class="l" id="185">185         <span class="php-keyword1">if</span> (!<span class="php-var">$clang</span>) {
</span><span class="l" id="186">186             <span class="php-var">$clang</span> = rex_clang::getCurrentId();
</span><span class="l" id="187">187         }
</span><span class="l" id="188">188 
</span><span class="l" id="189">189         <span class="php-var">$class</span> = <span class="php-keyword2">get_called_class</span>();
</span><span class="l" id="190">190         <span class="php-keyword1">return</span> <span class="php-keyword1">static</span>::getInstanceList(
</span><span class="l" id="191">191             <span class="php-comment">// list key</span>
</span><span class="l" id="192">192             [<span class="php-var">$parentId</span>, <span class="php-var">$listType</span>],
</span><span class="l" id="193">193             <span class="php-comment">// callback to get an instance for a given ID, status will be checked if $ignoreOfflines==true</span>
</span><span class="l" id="194">194             <span class="php-keyword1">function</span> (<span class="php-var">$id</span>) <span class="php-keyword1">use</span> (<span class="php-var">$class</span>, <span class="php-var">$ignoreOfflines</span>, <span class="php-var">$clang</span>) {
</span><span class="l" id="195">195                 <span class="php-keyword1">if</span> (<span class="php-var">$instance</span> = <span class="php-var">$class</span>::get(<span class="php-var">$id</span>, <span class="php-var">$clang</span>)) {
</span><span class="l" id="196">196                     <span class="php-keyword1">return</span> !<span class="php-var">$ignoreOfflines</span> || <span class="php-var">$instance</span>-&gt;isOnline() ? <span class="php-var">$instance</span> : <span class="php-keyword1">null</span>;
</span><span class="l" id="197">197                 }
</span><span class="l" id="198">198                 <span class="php-keyword1">return</span> <span class="php-keyword1">null</span>;
</span><span class="l" id="199">199             },
</span><span class="l" id="200">200             <span class="php-comment">// callback to create the list of IDs</span>
</span><span class="l" id="201">201             <span class="php-keyword1">function</span> (<span class="php-var">$parentId</span>, <span class="php-var">$listType</span>) {
</span><span class="l" id="202">202                 <span class="php-var">$listFile</span> = rex_path::addonCache(<span class="php-quote">'structure'</span>, <span class="php-var">$parentId</span> . <span class="php-quote">'.'</span> . <span class="php-var">$listType</span>);
</span><span class="l" id="203">203                 <span class="php-keyword1">if</span> (!<span class="php-keyword2">file_exists</span>(<span class="php-var">$listFile</span>)) {
</span><span class="l" id="204">204                     rex_article_cache::generateLists(<span class="php-var">$parentId</span>);
</span><span class="l" id="205">205                 }
</span><span class="l" id="206">206                 <span class="php-keyword1">return</span> rex_file::getCache(<span class="php-var">$listFile</span>);
</span><span class="l" id="207">207             }
</span><span class="l" id="208">208         );
</span><span class="l" id="209">209     }
</span><span class="l" id="210">210 
</span><span class="l" id="211">211     <span class="php-comment">/**
</span></span><span class="l" id="212">212 <span class="php-comment">     * Returns the clang of the category.
</span></span><span class="l" id="213">213 <span class="php-comment">     *
</span></span><span class="l" id="214">214 <span class="php-comment">     * @return int
</span></span><span class="l" id="215">215 <span class="php-comment">     *
</span></span><span class="l" id="216">216 <span class="php-comment">     * @deprecated since redaxo 5.6, use getClangId() instead
</span></span><span class="l" id="217">217 <span class="php-comment">     */</span>
</span><span class="l" id="218">218     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getClang()
</span><span class="l" id="219">219     {
</span><span class="l" id="220">220         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;clang_id;
</span><span class="l" id="221">221     }
</span><span class="l" id="222">222 
</span><span class="l" id="223">223     <span class="php-comment">/**
</span></span><span class="l" id="224">224 <span class="php-comment">     * Returns the clang of the category.
</span></span><span class="l" id="225">225 <span class="php-comment">     *
</span></span><span class="l" id="226">226 <span class="php-comment">     * @return int
</span></span><span class="l" id="227">227 <span class="php-comment">     */</span>
</span><span class="l" id="228">228     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getClangId()
</span><span class="l" id="229">229     {
</span><span class="l" id="230">230         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;clang_id;
</span><span class="l" id="231">231     }
</span><span class="l" id="232">232 
</span><span class="l" id="233">233     <span class="php-comment">/**
</span></span><span class="l" id="234">234 <span class="php-comment">     * Returns a url for linking to this article.
</span></span><span class="l" id="235">235 <span class="php-comment">     *
</span></span><span class="l" id="236">236 <span class="php-comment">     * @param array  $params
</span></span><span class="l" id="237">237 <span class="php-comment">     * @param string $divider
</span></span><span class="l" id="238">238 <span class="php-comment">     *
</span></span><span class="l" id="239">239 <span class="php-comment">     * @return string
</span></span><span class="l" id="240">240 <span class="php-comment">     */</span>
</span><span class="l" id="241">241     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getUrl(<span class="php-keyword1">array</span> <span class="php-var">$params</span> = [], <span class="php-var">$divider</span> = <span class="php-quote">'&amp;amp;'</span>)
</span><span class="l" id="242">242     {
</span><span class="l" id="243">243         <span class="php-keyword1">return</span> rex_getUrl(<span class="php-var">$this</span>-&gt;getId(), <span class="php-var">$this</span>-&gt;getClang(), <span class="php-var">$params</span>, <span class="php-var">$divider</span>);
</span><span class="l" id="244">244     }
</span><span class="l" id="245">245 
</span><span class="l" id="246">246     <span class="php-comment">/**
</span></span><span class="l" id="247">247 <span class="php-comment">     * Returns the id of the article.
</span></span><span class="l" id="248">248 <span class="php-comment">     *
</span></span><span class="l" id="249">249 <span class="php-comment">     * @return int
</span></span><span class="l" id="250">250 <span class="php-comment">     */</span>
</span><span class="l" id="251">251     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getId()
</span><span class="l" id="252">252     {
</span><span class="l" id="253">253         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;id;
</span><span class="l" id="254">254     }
</span><span class="l" id="255">255 
</span><span class="l" id="256">256     <span class="php-comment">/**
</span></span><span class="l" id="257">257 <span class="php-comment">     * Returns the parent_id of the article.
</span></span><span class="l" id="258">258 <span class="php-comment">     *
</span></span><span class="l" id="259">259 <span class="php-comment">     * @return int
</span></span><span class="l" id="260">260 <span class="php-comment">     */</span>
</span><span class="l" id="261">261     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getParentId()
</span><span class="l" id="262">262     {
</span><span class="l" id="263">263         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;parent_id;
</span><span class="l" id="264">264     }
</span><span class="l" id="265">265 
</span><span class="l" id="266">266     <span class="php-comment">/**
</span></span><span class="l" id="267">267 <span class="php-comment">     * Returns the path of the category/article.
</span></span><span class="l" id="268">268 <span class="php-comment">     *
</span></span><span class="l" id="269">269 <span class="php-comment">     * @return string
</span></span><span class="l" id="270">270 <span class="php-comment">     */</span>
</span><span class="l" id="271">271     <span class="php-keyword1">abstract</span> <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getPath();
</span><span class="l" id="272">272 
</span><span class="l" id="273">273     <span class="php-comment">/**
</span></span><span class="l" id="274">274 <span class="php-comment">     * Returns the path ids of the category/article as an array.
</span></span><span class="l" id="275">275 <span class="php-comment">     *
</span></span><span class="l" id="276">276 <span class="php-comment">     * @return int[]
</span></span><span class="l" id="277">277 <span class="php-comment">     */</span>
</span><span class="l" id="278">278     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getPathAsArray()
</span><span class="l" id="279">279     {
</span><span class="l" id="280">280         <span class="php-var">$path</span> = <span class="php-keyword2">explode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$this</span>-&gt;getPath());
</span><span class="l" id="281">281         <span class="php-keyword1">return</span> <span class="php-keyword2">array_values</span>(<span class="php-keyword2">array_map</span>(<span class="php-quote">'intval'</span>, <span class="php-keyword2">array_filter</span>(<span class="php-var">$path</span>)));
</span><span class="l" id="282">282     }
</span><span class="l" id="283">283 
</span><span class="l" id="284">284     <span class="php-comment">/**
</span></span><span class="l" id="285">285 <span class="php-comment">     * Returns the parent category.
</span></span><span class="l" id="286">286 <span class="php-comment">     *
</span></span><span class="l" id="287">287 <span class="php-comment">     * @return self
</span></span><span class="l" id="288">288 <span class="php-comment">     */</span>
</span><span class="l" id="289">289     <span class="php-keyword1">abstract</span> <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getParent();
</span><span class="l" id="290">290 
</span><span class="l" id="291">291     <span class="php-comment">/**
</span></span><span class="l" id="292">292 <span class="php-comment">     * Returns the name of the article.
</span></span><span class="l" id="293">293 <span class="php-comment">     *
</span></span><span class="l" id="294">294 <span class="php-comment">     * @return string
</span></span><span class="l" id="295">295 <span class="php-comment">     */</span>
</span><span class="l" id="296">296     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getName()
</span><span class="l" id="297">297     {
</span><span class="l" id="298">298         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;name;
</span><span class="l" id="299">299     }
</span><span class="l" id="300">300 
</span><span class="l" id="301">301     <span class="php-comment">/**
</span></span><span class="l" id="302">302 <span class="php-comment">     * Returns the article priority.
</span></span><span class="l" id="303">303 <span class="php-comment">     *
</span></span><span class="l" id="304">304 <span class="php-comment">     * @return int
</span></span><span class="l" id="305">305 <span class="php-comment">     */</span>
</span><span class="l" id="306">306     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getPriority()
</span><span class="l" id="307">307     {
</span><span class="l" id="308">308         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;priority;
</span><span class="l" id="309">309     }
</span><span class="l" id="310">310 
</span><span class="l" id="311">311     <span class="php-comment">/**
</span></span><span class="l" id="312">312 <span class="php-comment">     * Returns the last update user.
</span></span><span class="l" id="313">313 <span class="php-comment">     *
</span></span><span class="l" id="314">314 <span class="php-comment">     * @return string
</span></span><span class="l" id="315">315 <span class="php-comment">     */</span>
</span><span class="l" id="316">316     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getUpdateUser()
</span><span class="l" id="317">317     {
</span><span class="l" id="318">318         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;updateuser;
</span><span class="l" id="319">319     }
</span><span class="l" id="320">320 
</span><span class="l" id="321">321     <span class="php-comment">/**
</span></span><span class="l" id="322">322 <span class="php-comment">     * Returns the last update date.
</span></span><span class="l" id="323">323 <span class="php-comment">     *
</span></span><span class="l" id="324">324 <span class="php-comment">     * @return int
</span></span><span class="l" id="325">325 <span class="php-comment">     */</span>
</span><span class="l" id="326">326     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getUpdateDate()
</span><span class="l" id="327">327     {
</span><span class="l" id="328">328         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;updatedate;
</span><span class="l" id="329">329     }
</span><span class="l" id="330">330 
</span><span class="l" id="331">331     <span class="php-comment">/**
</span></span><span class="l" id="332">332 <span class="php-comment">     * Returns the creator.
</span></span><span class="l" id="333">333 <span class="php-comment">     *
</span></span><span class="l" id="334">334 <span class="php-comment">     * @return string
</span></span><span class="l" id="335">335 <span class="php-comment">     */</span>
</span><span class="l" id="336">336     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getCreateUser()
</span><span class="l" id="337">337     {
</span><span class="l" id="338">338         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;createuser;
</span><span class="l" id="339">339     }
</span><span class="l" id="340">340 
</span><span class="l" id="341">341     <span class="php-comment">/**
</span></span><span class="l" id="342">342 <span class="php-comment">     * Returns the creation date.
</span></span><span class="l" id="343">343 <span class="php-comment">     *
</span></span><span class="l" id="344">344 <span class="php-comment">     * @return int
</span></span><span class="l" id="345">345 <span class="php-comment">     */</span>
</span><span class="l" id="346">346     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getCreateDate()
</span><span class="l" id="347">347     {
</span><span class="l" id="348">348         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;createdate;
</span><span class="l" id="349">349     }
</span><span class="l" id="350">350 
</span><span class="l" id="351">351     <span class="php-comment">/**
</span></span><span class="l" id="352">352 <span class="php-comment">     * Returns true if article is online.
</span></span><span class="l" id="353">353 <span class="php-comment">     *
</span></span><span class="l" id="354">354 <span class="php-comment">     * @return bool
</span></span><span class="l" id="355">355 <span class="php-comment">     */</span>
</span><span class="l" id="356">356     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> isOnline()
</span><span class="l" id="357">357     {
</span><span class="l" id="358">358         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;status == <span class="php-num">1</span>;
</span><span class="l" id="359">359     }
</span><span class="l" id="360">360 
</span><span class="l" id="361">361     <span class="php-comment">/**
</span></span><span class="l" id="362">362 <span class="php-comment">     * Returns the template id.
</span></span><span class="l" id="363">363 <span class="php-comment">     *
</span></span><span class="l" id="364">364 <span class="php-comment">     * @return int
</span></span><span class="l" id="365">365 <span class="php-comment">     */</span>
</span><span class="l" id="366">366     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getTemplateId()
</span><span class="l" id="367">367     {
</span><span class="l" id="368">368         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;template_id;
</span><span class="l" id="369">369     }
</span><span class="l" id="370">370 
</span><span class="l" id="371">371     <span class="php-comment">/**
</span></span><span class="l" id="372">372 <span class="php-comment">     * Returns true if article has a template.
</span></span><span class="l" id="373">373 <span class="php-comment">     *
</span></span><span class="l" id="374">374 <span class="php-comment">     * @return bool
</span></span><span class="l" id="375">375 <span class="php-comment">     */</span>
</span><span class="l" id="376">376     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> hasTemplate()
</span><span class="l" id="377">377     {
</span><span class="l" id="378">378         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;template_id &gt; <span class="php-num">0</span>;
</span><span class="l" id="379">379     }
</span><span class="l" id="380">380 
</span><span class="l" id="381">381     <span class="php-comment">/**
</span></span><span class="l" id="382">382 <span class="php-comment">     * Returns whether the element is permitted.
</span></span><span class="l" id="383">383 <span class="php-comment">     *
</span></span><span class="l" id="384">384 <span class="php-comment">     * @return bool
</span></span><span class="l" id="385">385 <span class="php-comment">     */</span>
</span><span class="l" id="386">386     <span class="php-keyword1">abstract</span> <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> isPermitted();
</span><span class="l" id="387">387 
</span><span class="l" id="388">388     <span class="php-comment">/**
</span></span><span class="l" id="389">389 <span class="php-comment">     * Returns a link to this article.
</span></span><span class="l" id="390">390 <span class="php-comment">     *
</span></span><span class="l" id="391">391 <span class="php-comment">     * @param array  $params             Parameter f√ºr den Link
</span></span><span class="l" id="392">392 <span class="php-comment">     * @param array  $attributes         Attribute die dem Link hinzugef√ºgt werden sollen. Default: array
</span></span><span class="l" id="393">393 <span class="php-comment">     * @param string $sorroundTag        HTML-Tag-Name mit dem der Link umgeben werden soll, z.b. 'li', 'div'. Default: null
</span></span><span class="l" id="394">394 <span class="php-comment">     * @param array  $sorroundAttributes Attribute die Umgebenden-Element hinzugef√ºgt werden sollen. Default: array
</span></span><span class="l" id="395">395 <span class="php-comment">     *
</span></span><span class="l" id="396">396 <span class="php-comment">     * @return string
</span></span><span class="l" id="397">397 <span class="php-comment">     */</span>
</span><span class="l" id="398">398     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> toLink(<span class="php-keyword1">array</span> <span class="php-var">$params</span> = [], <span class="php-keyword1">array</span> <span class="php-var">$attributes</span> = [], <span class="php-var">$sorroundTag</span> = <span class="php-keyword1">null</span>, <span class="php-keyword1">array</span> <span class="php-var">$sorroundAttributes</span> = [])
</span><span class="l" id="399">399     {
</span><span class="l" id="400">400         <span class="php-var">$name</span> = <span class="php-keyword2">htmlspecialchars</span>(<span class="php-var">$this</span>-&gt;getName());
</span><span class="l" id="401">401         <span class="php-var">$link</span> = <span class="php-quote">'&lt;a href="'</span> . <span class="php-var">$this</span>-&gt;getUrl(<span class="php-var">$params</span>) . <span class="php-quote">'"'</span> . <span class="php-var">$this</span>-&gt;_toAttributeString(<span class="php-var">$attributes</span>) . <span class="php-quote">' title="'</span> . <span class="php-var">$name</span> . <span class="php-quote">'"&gt;'</span> . <span class="php-var">$name</span> . <span class="php-quote">'&lt;/a&gt;'</span>;
</span><span class="l" id="402">402 
</span><span class="l" id="403">403         <span class="php-keyword1">if</span> (<span class="php-var">$sorroundTag</span> !== <span class="php-keyword1">null</span> &amp;&amp; <span class="php-keyword2">is_string</span>(<span class="php-var">$sorroundTag</span>)) {
</span><span class="l" id="404">404             <span class="php-var">$link</span> = <span class="php-quote">'&lt;'</span> . <span class="php-var">$sorroundTag</span> . <span class="php-var">$this</span>-&gt;_toAttributeString(<span class="php-var">$sorroundAttributes</span>) . <span class="php-quote">'&gt;'</span> . <span class="php-var">$link</span> . <span class="php-quote">'&lt;/'</span> . <span class="php-var">$sorroundTag</span> . <span class="php-quote">'&gt;'</span>;
</span><span class="l" id="405">405         }
</span><span class="l" id="406">406 
</span><span class="l" id="407">407         <span class="php-keyword1">return</span> <span class="php-var">$link</span>;
</span><span class="l" id="408">408     }
</span><span class="l" id="409">409 
</span><span class="l" id="410">410     <span class="php-comment">/**
</span></span><span class="l" id="411">411 <span class="php-comment">     * @param array $attributes
</span></span><span class="l" id="412">412 <span class="php-comment">     *
</span></span><span class="l" id="413">413 <span class="php-comment">     * @return string
</span></span><span class="l" id="414">414 <span class="php-comment">     */</span>
</span><span class="l" id="415">415     <span class="php-keyword1">protected</span> <span class="php-keyword1">function</span> _toAttributeString(<span class="php-keyword1">array</span> <span class="php-var">$attributes</span>)
</span><span class="l" id="416">416     {
</span><span class="l" id="417">417         <span class="php-var">$attr</span> = <span class="php-quote">''</span>;
</span><span class="l" id="418">418 
</span><span class="l" id="419">419         <span class="php-keyword1">if</span> (<span class="php-var">$attributes</span> !== <span class="php-keyword1">null</span> &amp;&amp; <span class="php-keyword2">is_array</span>(<span class="php-var">$attributes</span>)) {
</span><span class="l" id="420">420             <span class="php-keyword1">foreach</span> (<span class="php-var">$attributes</span> <span class="php-keyword1">as</span> <span class="php-var">$name</span> =&gt; <span class="php-var">$value</span>) {
</span><span class="l" id="421">421                 <span class="php-var">$attr</span> .= <span class="php-quote">' '</span> . <span class="php-var">$name</span> . <span class="php-quote">'="'</span> . <span class="php-var">$value</span> . <span class="php-quote">'"'</span>;
</span><span class="l" id="422">422             }
</span><span class="l" id="423">423         }
</span><span class="l" id="424">424 
</span><span class="l" id="425">425         <span class="php-keyword1">return</span> <span class="php-var">$attr</span>;
</span><span class="l" id="426">426     }
</span><span class="l" id="427">427 
</span><span class="l" id="428">428     <span class="php-comment">/**
</span></span><span class="l" id="429">429 <span class="php-comment">     * Get an array of all parentCategories.
</span></span><span class="l" id="430">430 <span class="php-comment">     * Returns an array of rex_structure_element objects.
</span></span><span class="l" id="431">431 <span class="php-comment">     *
</span></span><span class="l" id="432">432 <span class="php-comment">     * @return rex_category[]
</span></span><span class="l" id="433">433 <span class="php-comment">     */</span>
</span><span class="l" id="434">434     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> getParentTree()
</span><span class="l" id="435">435     {
</span><span class="l" id="436">436         <span class="php-var">$return</span> = [];
</span><span class="l" id="437">437 
</span><span class="l" id="438">438         <span class="php-keyword1">if</span> (<span class="php-var">$this</span>-&gt;path) {
</span><span class="l" id="439">439             <span class="php-keyword1">if</span> (<span class="php-var">$this</span>-&gt;isStartArticle()) {
</span><span class="l" id="440">440                 <span class="php-var">$explode</span> = <span class="php-keyword2">explode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$this</span>-&gt;path . <span class="php-var">$this</span>-&gt;id . <span class="php-quote">'|'</span>);
</span><span class="l" id="441">441             } <span class="php-keyword1">else</span> {
</span><span class="l" id="442">442                 <span class="php-var">$explode</span> = <span class="php-keyword2">explode</span>(<span class="php-quote">'|'</span>, <span class="php-var">$this</span>-&gt;path);
</span><span class="l" id="443">443             }
</span><span class="l" id="444">444 
</span><span class="l" id="445">445             <span class="php-keyword1">if</span> (<span class="php-keyword2">is_array</span>(<span class="php-var">$explode</span>)) {
</span><span class="l" id="446">446                 <span class="php-keyword1">foreach</span> (<span class="php-var">$explode</span> <span class="php-keyword1">as</span> <span class="php-var">$var</span>) {
</span><span class="l" id="447">447                     <span class="php-keyword1">if</span> (<span class="php-var">$var</span> != <span class="php-quote">''</span>) {
</span><span class="l" id="448">448                         <span class="php-var">$return</span>[] = rex_category::get(<span class="php-var">$var</span>, <span class="php-var">$this</span>-&gt;clang_id);
</span><span class="l" id="449">449                     }
</span><span class="l" id="450">450                 }
</span><span class="l" id="451">451             }
</span><span class="l" id="452">452         }
</span><span class="l" id="453">453 
</span><span class="l" id="454">454         <span class="php-keyword1">return</span> <span class="php-var">$return</span>;
</span><span class="l" id="455">455     }
</span><span class="l" id="456">456 
</span><span class="l" id="457">457     <span class="php-comment">/**
</span></span><span class="l" id="458">458 <span class="php-comment">     * Checks if $anObj is in the parent tree of the object.
</span></span><span class="l" id="459">459 <span class="php-comment">     *
</span></span><span class="l" id="460">460 <span class="php-comment">     * @param self $anObj
</span></span><span class="l" id="461">461 <span class="php-comment">     *
</span></span><span class="l" id="462">462 <span class="php-comment">     * @return bool
</span></span><span class="l" id="463">463 <span class="php-comment">     */</span>
</span><span class="l" id="464">464     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> inParentTree(self <span class="php-var">$anObj</span>)
</span><span class="l" id="465">465     {
</span><span class="l" id="466">466         <span class="php-var">$tree</span> = <span class="php-var">$this</span>-&gt;getParentTree();
</span><span class="l" id="467">467         <span class="php-keyword1">foreach</span> (<span class="php-var">$tree</span> <span class="php-keyword1">as</span> <span class="php-var">$treeObj</span>) {
</span><span class="l" id="468">468             <span class="php-keyword1">if</span> (<span class="php-var">$treeObj</span> == <span class="php-var">$anObj</span>) {
</span><span class="l" id="469">469                 <span class="php-keyword1">return</span> <span class="php-keyword1">true</span>;
</span><span class="l" id="470">470             }
</span><span class="l" id="471">471         }
</span><span class="l" id="472">472         <span class="php-keyword1">return</span> <span class="php-keyword1">false</span>;
</span><span class="l" id="473">473     }
</span><span class="l" id="474">474 
</span><span class="l" id="475">475     <span class="php-comment">/**
</span></span><span class="l" id="476">476 <span class="php-comment">     * Returns true if this Article is the Startpage for the category.
</span></span><span class="l" id="477">477 <span class="php-comment">     *
</span></span><span class="l" id="478">478 <span class="php-comment">     * @return bool
</span></span><span class="l" id="479">479 <span class="php-comment">     */</span>
</span><span class="l" id="480">480     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> isStartArticle()
</span><span class="l" id="481">481     {
</span><span class="l" id="482">482         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;startarticle;
</span><span class="l" id="483">483     }
</span><span class="l" id="484">484 
</span><span class="l" id="485">485     <span class="php-comment">/**
</span></span><span class="l" id="486">486 <span class="php-comment">     * Returns true if this Article is the Startpage for the entire site.
</span></span><span class="l" id="487">487 <span class="php-comment">     *
</span></span><span class="l" id="488">488 <span class="php-comment">     * @return bool
</span></span><span class="l" id="489">489 <span class="php-comment">     */</span>
</span><span class="l" id="490">490     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> isSiteStartArticle()
</span><span class="l" id="491">491     {
</span><span class="l" id="492">492         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;id == rex_article::getSiteStartArticleId();
</span><span class="l" id="493">493     }
</span><span class="l" id="494">494 
</span><span class="l" id="495">495     <span class="php-comment">/**
</span></span><span class="l" id="496">496 <span class="php-comment">     * Returns  true if this Article is the not found article.
</span></span><span class="l" id="497">497 <span class="php-comment">     *
</span></span><span class="l" id="498">498 <span class="php-comment">     * @return bool
</span></span><span class="l" id="499">499 <span class="php-comment">     */</span>
</span><span class="l" id="500">500     <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> isNotFoundArticle()
</span><span class="l" id="501">501     {
</span><span class="l" id="502">502         <span class="php-keyword1">return</span> <span class="php-var">$this</span>-&gt;id == rex_article::getNotfoundArticleId();
</span><span class="l" id="503">503     }
</span><span class="l" id="504">504 }
</span><span class="l" id="505">505 </span></code></pre>
 </body>
</html>
